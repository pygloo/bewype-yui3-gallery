YUI.add("bewype-layout-designer-places",function(B){var A=function(C){A.superclass.constructor.apply(this,arguments);};A.NAME="layout-designer-places";A.NS="layoutDesignerPlaces";B.extend(A,B.Bewype.LayoutDesignerConfig,{placesNode:null,contents:null,sortable:null,_initSortable:function(){var C=this.get("host"),F=this.get("baseNode"),D=F.one("."+this.get("designerClass")+"-sources"),E=D.layoutDesignerSources.sortable;this.sortable=new B.Sortable({container:C,nodes:"li",opacity:".2"});E.join(this.sortable,"outer");},initializer:function(C){this.setAttrs(C);var F=this.get("host"),E=this.get("designerClass"),D=this.get("placesType"),G="."+E+"-src";this.contents=[];F.removeClass(E+"-src");F.removeClass(E+"-src-"+D);F.addClass(E+"-places");F.addClass(E+"-places-"+D);F.all(G).each(function(I,H){var J=this.getAttrs();J.parentNode=F;I.plug(B.Bewype.LayoutDesignerContent,J);this.contents.push(I);},this);this._initSortable();},destructor:function(){var C=this.get("host"),D=this.get("parentNode");B.Object.each(this.contents,function(F,E){if(F.layoutDesignerPlaces){F.unplug(B.Bewype.LayoutDesignerPlaces);}else{if(F.layoutDesignerContent){F.unplug(B.Bewype.LayoutDesignerContent);}else{}}},this);if(D){D.layoutDesignerPlaces.unRegisterContent(C);}},refresh:function(E){var D=this.get("host"),C=this.get("placesType"),G=this.getPlacesHeight(),I=this.getPlacesWidth(),H=this.get("parentNode"),F=null;G=G===0?this.get("contentHeight"):G;I=I>E?E:I;I=I===0?this.getAvailablePlace():I;D.setStyle("height",G);D.setStyle("width",I);switch(C){case"vertical":F=I;B.each(this.contents,function(L,K){var J=null;if(L.layoutDesignerPlaces){J=L.layoutDesignerPlaces.get("host");J.setStyle("width",F);if(E){L.layoutDesignerPlaces.refresh(F);}}else{if(E){L.layoutDesignerContent.refresh(F);}}});break;case"horizontal":F=E?(E/this.contents.length):null;B.Object.each(this.contents,function(L,K){var J=null,M=null;if(L.layoutDesignerPlaces){J=L.layoutDesignerPlaces.get("host");if(F){L.layoutDesignerPlaces.refresh(F);}}else{if(L.layoutDesignerContent){J=L.layoutDesignerContent.get("host");if(F){L.layoutDesignerContent.refresh(F);}}}M=J?J.ancestor("li"):null;if(M){M.setStyle("height",G);M.setStyle("vertical-align","top");}},this);break;}return F;},cleanContentOver:function(){B.each(this.contents,function(D,C){if(D.layoutDesignerContent){D.layoutDesignerContent._q.stop();D.layoutDesignerContent.hideClone();}});},getMaxWidth:function(){return B.Bewype.Utils.getWidth(this.get("host"));},hasPlace:function(D){var C=this.getAvailablePlace(),E=this.get("placesType");D=D?D:this.get("contentWidth");return E==="vertical"||C>=D;},hasSubPlaces:function(){var C=false;B.each(this.contents,function(E,D){if(E.layoutDesignerPlaces){C=true;}});return C;},getAvailablePlace:function(){var D=this.get("placesType"),E=this.getMaxWidth(),C=this.getPlacesWidth();if(D==="vertical"){return C===0?E:C;}else{return E-C;}},getPlacesWidth:function(){var C=0,D=this.get("parentNode")||this.get("host");switch(this.get("placesType")){case"vertical":if(!this.get("parentNode")){return B.Bewype.Utils.getWidth(D);}B.each(this.contents,function(F,E){var G=0;if(F.layoutDesignerPlaces){G=F.layoutDesignerPlaces.getPlacesWidth();}else{if(F.layoutDesignerContent){G=F.layoutDesignerContent.getContentWidth();}}if(G>C){C=G;}});break;case"horizontal":B.each(this.contents,function(F,E){if(F.layoutDesignerPlaces){C+=F.layoutDesignerPlaces.getPlacesWidth();}else{if(F.layoutDesignerContent){C+=F.layoutDesignerContent.getContentWidth();}}});break;}return C;},getPlacesHeight:function(){var C=0;switch(this.get("placesType")){case"vertical":B.each(this.contents,function(E,D){if(E.layoutDesignerPlaces){C+=E.layoutDesignerPlaces.getPlacesHeight();}else{if(E.layoutDesignerContent){C+=E.layoutDesignerContent.getContentHeight();}}});break;case"horizontal":B.each(this.contents,function(E,D){var F=0;if(E.layoutDesignerPlaces){F=E.layoutDesignerPlaces.getPlacesHeight();}else{if(E.layoutDesignerContent){F=E.layoutDesignerContent.getContentHeight();}}if(F>C){C=F;}});break;}return C;},registerContent:function(C){this.contents.push(C);},unRegisterContent:function(C){var D=this.contents.indexOf(C);if(D!=-1){this.contents.splice(D,1);}},getContents:function(){var C=[];B.each(this.contents,function(E,D){if(E.layoutDesignerPlaces){C=C.concat(E.layoutDesignerPlaces.getContents());}else{C.push(E);}});return C;},removeContent:function(C,F){var I=C.ancestor("li"),E=this.get("host"),H=this.get("baseNode"),D=this.get("designerClass"),G=H.one("."+D+"-layout ul");this.unRegisterContent(C);C.unplug(B.Bewype.LayoutDesignerContent);I.remove();if(this.contents.length===0&&E!=G){E.unplug(B.Bewype.LayoutDesignerPlaces);}else{if(E.layoutDesignerPlaces){E.layoutDesignerPlaces.refresh();}}}});B.namespace("Bewype");B.Bewype.LayoutDesignerPlaces=A;},"@VERSION@",{requires:["sortable","dd-constrain","bewype-layout-designer-content-text"]});