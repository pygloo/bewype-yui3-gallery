YUI.add("bewype-layout-designer-content-base",function(a){var b=function(c){b.superclass.constructor.apply(this,arguments);};b.NAME="layout-designer-content";b.NS="layoutDesignerContent";a.extend(b,a.Bewype.LayoutDesignerConfig,{_q:null,editing:false,_init:function(d){var c=this.get("host"),f=this.get("parentNode"),e=null;e=new a.Node.create(a.substitute(d,{designerClass:this.get("designerClass"),contentType:this.get("contentType")}));c.append(e);e.setStyle("height",this.get("contentHeight"));e.setStyle("width",this.get("contentWidth"));f.layoutDesignerPlaces.registerContent(c);this._q=new a.AsyncQueue();return e;},initializer:function(c){this.setAttrs(c);this._addCloneNode();},destructor:function(){var e=this.get("host"),h=this.get("parentNode"),d=this.get("designerClass")+"-content",f=this.get("contentType")==="image"?"img.":"div.",g=e.one(f+d),c=e.one("div."+d+"-clone");if(this.editing===true){this._detachEditor();}h.layoutDesignerPlaces.unRegisterContent(e);e.detachAll("mouseenter");if(c){c.one("."+d+"-clone-edit").detachAll("click");c.one("."+d+"-clone-remove").detachAll("click");c.remove();}e.replace(g);},_detachEditor:function(){var f=this.get("host"),e=this.get("baseNode"),j=this.get("designerClass")+"-sources",d=this.get("designerClass")+"-edit-panel",i=e.one("div."+j),c=e.one("div."+d),h=this.get("contentType")==="image"?a.Bewype.EditorTag:a.Bewype.EditorText,g=this.getContentNode();this.editing=false;if(c&&c.bewypeEditorPanel){c.unplug(a.Bewype.EditorPanel);g.unplug(h);f.detachAll("bewype-editor:onClose");f.detachAll("bewype-editor:onChange");this.refresh();}if(c){c.setStyle("display","none");}if(i){i.setStyle("display","block");}this._refreshCloneNode();return true;},_attachEditor:function(){var n=this.get("host"),g=this.get("baseNode"),d=this.get("parentNode"),m=this.get("designerClass")+"-sources",l=this.get("designerClass")+"-edit-panel",r=g.one("div."+m),k=g.one("div."+l),q=d.layoutDesignerPlaces,f=q.get("placesType"),i=this.get("contentType")==="image"?a.Bewype.EditorTag:a.Bewype.EditorText,e=this.get("contentType")==="image"?"editorImageButtons":"editorTextButtons",j=this.getContentNode(),h=null,p=null,o=(f==="vertical")?q.get("parentNode"):null,c=o?o.layoutDesignerPlaces:null;r.setStyle("display","none");k.setStyle("display","block");if(f==="vertical"){p=d.layoutDesignerPlaces.getMaxWidth();p+=c?c.getAvailablePlace():0;}else{p=d.layoutDesignerPlaces.getAvailablePlace();p+=this.getContentWidth();}h={panelNode:k,spinnerMaxWidth:p,activeButtons:this.get(e)};j.plug(i,h);a.on("bewype-editor:onClose",a.bind(this._detachEditor,this),j);a.on("bewype-editor:onChange",a.bind(this.refresh,this),j);this.editing=true;},_onClickEdit:function(c){var d=this.get("parentNode");a.each(d.layoutDesignerPlaces.getContents(),function(f,e){f.layoutDesignerContent._detachEditor();});this._attachEditor();},_onClickRemove:function(c){var d=this.get("host"),e=this.get("parentNode");e.layoutDesignerPlaces.removeContent(d);},_addCloneNode:function(){var f=this.get("host"),e=this.get("designerClass")+"-content",c=new a.Node.create('<div class="'+e+'-clone-callbacks" />'),d=null,i=null,g=null,h=null;d=f.cloneNode(false);d.set("innerHTML","");d.set("className",e+"-clone");f.append(d);d.setStyle("z-index",this.get("contentZIndex"));d.setStyle("position","absolute");d.setStyle("bottom",0);d.append(c);i=new a.Node.create('<div class="'+e+'-clone-drag" />');c.append(i);g=new a.Node.create('<div class="'+e+'-clone-edit" />');c.append(g);a.on("click",a.bind(this._onClickEdit,this),g);h=new a.Node.create('<div class="'+e+'-clone-remove" />');c.append(h);a.on("click",a.bind(this._onClickRemove,this),h);this._refreshCloneNode();},getContentHeight:function(){var f=this.getContentNode(),c=a.Bewype.Utils.getHeight(f),e=a.Bewype.Utils.getStyleValue(f,"paddingTop")||0,d=a.Bewype.Utils.getStyleValue(f,"paddingBottom")||0;return c+e+d;},getContentWidth:function(){var f=this.getContentNode(),e=a.Bewype.Utils.getWidth(f),d=a.Bewype.Utils.getStyleValue(f,"paddingRight")||0,c=a.Bewype.Utils.getStyleValue(f,"paddingLeft")||0;return e+c+d;},getContentNode:function(){var d=this.get("host"),c=this.get("designerClass")+"-content",e=this.get("contentType")==="image"?"img.":"div.";return d.one(e+c);},_refreshCloneNode:function(g){var f=this.get("host"),e=this.get("designerClass")+"-content",d=f.one("div."+e+"-clone"),h=this.getContentHeight(),c=g||this.getContentWidth();if(d){d.setStyle("height",h-2);d.setStyle("width",c-2);}},refresh:function(c){var e=this.get("parentNode"),d=c?this.getContentNode():null;if(d){d.setStyle("width",c);d.setStyle("paddingLeft",0);d.setStyle("paddingRight",0);}this._refreshCloneNode(c);e.layoutDesignerTarget.refresh();}});a.namespace("Bewype");a.Bewype.LayoutDesignerContentBase=b;},"@VERSION@",{requires:["async-queue","plugin","substitute"]});