YUI.add("bewype-layout-designer-base",function(A){var B=function(C){B.superclass.constructor.apply(this,arguments);};B.NODE_SRC_TEMPLATE='<div class="{designerClass}-sources"></div>';B.NODE_PAN_TEMPLATE='<div class="{designerClass}-edit-panel"></div>';B.NODE_LAYOUT_TEMPLATE='<div class="{designerClass}-layout"><ul /></div>';B.NAME="layout-designer";B.NS="layoutDesigner";A.extend(B,A.Bewype.LayoutDesignerConfig,{nodeSource:null,nodeLayout:null,_dropHitGotcha:function(O){var M=this.get("host"),F=O.target.get("node"),P=this.get("designerClass"),E="."+P+"-content",K="."+P+"-src",J=F.one(E)||F.one(K),D=J.get("tagName").toLowerCase(),N=F.ancestor("ul"),G=null,L=null,C=null,H=null,I=null;if(!N.layoutDesignerPlaces){return;}else{if(J.layoutDesignerContent){G=J.layoutDesignerContent.get("parentNode");}else{if(J.layoutDesignerPlaces){G=J.layoutDesignerPlaces.get("parentNode");}else{L=this.getAttrs();L.baseNode=M;L.parentNode=M;if(D==="div"){L.contentType="text";J.plug(A.Bewype.LayoutDesignerContent,L);this.nodeSource.layoutDesignerSources.addTextSource();}else{if(D==="img"){L.contentType="image";J.plug(A.Bewype.LayoutDesignerContent,L);this.nodeSource.layoutDesignerSources.addImageSource();}else{if(D==="table"){I=A.Node.create("<ul/>");J.all("td").each(function(R,Q){var U=this.getAttrs(),T=R.one("div").cloneNode(true),S=A.Node.create("<li />");S.append(T);I.append(S);},this);J.replace(I);L.placesType=this.get("startingType")==="horizontal"?"vertical":"horizontal";J.plug(A.Bewype.LayoutDesignerPlaces,L);this.nodeSource.layoutDesignerSources.addRowSource();}else{return;}}}}}}if(G!=N){if(G){G.layoutDesignerPlaces.unRegisterContent(J);}N.layoutDesignerPlaces.registerContent(J);if(J.layoutDesignerContent){J.layoutDesignerContent.set("parentNode",N);}else{J.layoutDesignerPlaces.set("parentNode",N);}C=N.layoutDesignerPlaces.getMaxWidth();H=N.layoutDesignerPlaces.refresh(C);if(J.layoutDesignerContent){J.layoutDesignerContent.get("host").setStyle("width",H);}}},initializer:function(C){this.setAttrs(C);var E=this.get("host"),F=null,D=this.get("designerClass"),G=this.get("layoutWidth");C.baseNode=E;C.placesType=this.get("startingType");this.nodeSource=new A.Node.create(A.substitute(B.NODE_SRC_TEMPLATE,{designerClass:D}));E.append(this.nodeSource);this.nodeSource.plug(A.Bewype.LayoutDesignerSources,C);F=new A.Node.create(A.substitute(B.NODE_PAN_TEMPLATE,{designerClass:D}));E.append(F);this.nodeLayout=new A.Node.create(A.substitute(B.NODE_LAYOUT_TEMPLATE,{designerClass:D}));E.append(this.nodeLayout);this.nodeLayout.setStyle("width",G);this.nodeLayout.one("ul").plug(A.Bewype.LayoutDesignerPlaces,C);this.nodeLayout.one("ul").layoutDesignerPlaces.refresh();A.DD.DDM.on("drag:end",A.bind(this._dropHitGotcha,this));},destructor:function(){var E=this.get("host"),D=this.get("designerClass"),F=E.one("."+D+"-sources"),C=E.one("."+D+"-edit-panel"),G=this.nodeLayout.one("table")||this.nodeLayout.one("ul");F.remove();C.remove();this.nodeLayout.unplug(A.Bewype.LayoutDesignerPlaces);if(G){this.nodeLayout.replace(G);}else{this.nodeLayout.remove();}},getContents:function(){if(this.nodeLayout.layoutDesignerPlaces){return this.nodeLayout.layoutDesignerPlaces.getContents();}else{return[];}}});A.namespace("Bewype");A.Bewype.LayoutDesigner=B;},"@VERSION@",{requires:["bewype-layout-designer-sources","bewype-layout-designer-target"]});