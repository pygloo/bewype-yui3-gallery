YUI.add("bewype-layout-designer-base",function(a){var b=function(c){b.superclass.constructor.apply(this,arguments);};b.NODE_SRC_TEMPLATE='<div class="{designerClass}-sources"></div>';b.NODE_PAN_TEMPLATE='<div class="{designerClass}-edit-panel"></div>';b.NODE_LAYOUT_TEMPLATE='<div class="{designerClass}-layout"><ul /></div>';b.NAME="layout-designer";b.NS="layoutDesigner";a.extend(b,a.Bewype.LayoutDesignerConfig,{nodeSource:null,nodeLayout:null,_dropHitGotcha:function(p){var n=this.get("host"),f=p.target.get("node"),q=this.get("designerClass"),e="."+q+"-content",l="."+q+"-src",k=f.one(e)||f.one(l),d=k.get("tagName").toLowerCase(),o=f.ancestor("ul"),h=null,m=null,c=null,i=null,j=null,g=null;if(!o.layoutDesignerPlaces){return;}else{if(k.layoutDesignerContent){h=k.layoutDesignerContent.get("parentNode");}else{if(k.layoutDesignerPlaces){h=k.layoutDesignerPlaces.get("parentNode");}else{g=[];if(d==="div"){g.push(k.cloneNode(true));this.nodeSource.layoutDesignerSources.addTextSource();}else{if(d==="img"){g.push(k.cloneNode(true));this.nodeSource.layoutDesignerSources.addImageSource();}else{if(d==="table"){k.all("td").each(function(s,r){var t=s.one("div")||s.one("img");g.push(t.cloneNode(true));},this);this.nodeSource.layoutDesignerSources.addRowSource();}else{return;}}}}}}if(g){j=a.Node.create("<ul/>");a.each(g,function(s,r){var t=a.Node.create("<li />");t.append(s);j.append(t);});k.replace(j);k=j;m=this.getAttrs();m.baseNode=n;m.parentNode=n;m.placesType=this.get("startingType")==="horizontal"?"vertical":"horizontal";k.plug(a.Bewype.LayoutDesignerPlaces,m);o.layoutDesignerPlaces.registerContent(k);k.layoutDesignerPlaces.set("parentNode",o);c=o.layoutDesignerPlaces.getMaxWidth();i=o.layoutDesignerPlaces.refresh(c);k.layoutDesignerPlaces.refresh(c,true);if(_placesType==="vertical"){_srcSortable.join(this.sortable,"outer");}this.nodeLayout.one("ul").all("ul").each(function(s,r){if(s!=k){s.layoutDesignerPlaces.sortable.join(k.layoutDesignerPlaces.sortable,"full");}},this);}},initializer:function(c){this.setAttrs(c);var e=this.get("host"),f=null,d=this.get("designerClass"),g=this.get("layoutWidth");c.baseNode=e;c.placesType=this.get("startingType");this.nodeSource=new a.Node.create(a.substitute(b.NODE_SRC_TEMPLATE,{designerClass:d}));e.append(this.nodeSource);this.nodeSource.plug(a.Bewype.LayoutDesignerSources,c);f=new a.Node.create(a.substitute(b.NODE_PAN_TEMPLATE,{designerClass:d}));e.append(f);this.nodeLayout=new a.Node.create(a.substitute(b.NODE_LAYOUT_TEMPLATE,{designerClass:d}));e.append(this.nodeLayout);this.nodeLayout.setStyle("width",g);this.nodeLayout.one("ul").plug(a.Bewype.LayoutDesignerPlaces,c);this.nodeLayout.one("ul").layoutDesignerPlaces.refresh();this.nodeSource.layoutDesignerSources.sortable.join(this.nodeLayout.one("ul").layoutDesignerPlaces.sortable,"outer");a.DD.DDM.on("drag:end",a.bind(this._dropHitGotcha,this));},destructor:function(){var e=this.get("host"),d=this.get("designerClass"),f=e.one("."+d+"-sources"),c=e.one("."+d+"-edit-panel"),g=this.nodeLayout.one("table")||this.nodeLayout.one("ul");f.remove();c.remove();this.nodeLayout.unplug(a.Bewype.LayoutDesignerPlaces);if(g){this.nodeLayout.replace(g);}else{this.nodeLayout.remove();}}});a.namespace("Bewype");a.Bewype.LayoutDesigner=b;},"@VERSION@",{requires:["bewype-layout-designer-sources","bewype-layout-designer-target"]});