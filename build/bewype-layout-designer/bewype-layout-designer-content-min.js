YUI.add("bewype-layout-designer-content",function(B){var A=function(C){A.superclass.constructor.apply(this,arguments);};A.NAME="layout-designer-content";A.NS="layoutDesignerContent";B.extend(A,B.Bewype.LayoutDesignerConfig,{_q:null,editing:false,initializer:function(C){this.setAttrs(C);var E=this.get("host"),D=this.get("designerClass"),F=this.get("contentType");E.removeClass(D+"-src");E.addClass(D+"-content");E.addClass(D+"-content-"+F);B.on("mouseenter",B.bind(this._onMouseEnter,this),E);this._q=new B.AsyncQueue();},destructor:function(){var E=this.get("host"),F=this.get("parentNode"),D=this.get("designerClass")+"-content",C=this.getCloneNode();if(this.editing===true){this._detachEditor();}F.layoutDesignerPlaces.unRegisterContent(E);E.detachAll("mouseenter");if(C){C.one("."+D+"-clone-edit").detachAll("click");C.one("."+D+"-clone-remove").detachAll("click");C.remove();}},getCloneNode:function(){var E=this.get("host"),C=E.ancestor("div"),D=this.get("designerClass")+"-content";return C.one("div."+D+"-clone");},hideClone:function(C){C=C||this.getCloneNode();if(C){B.each(C.all("div"),function(E,D){E.setStyle("visibility","hidden");});C.setStyle("visibility","hidden");}},_addCloneNode:function(){var G=this.get("host"),D=G.ancestor("div"),F=this.get("designerClass")+"-content",E=new B.Node.create('<div class="'+F+'-clone" />'),C=new B.Node.create('<div class="'+F+'-clone-callbacks" />'),H=null,I=null;D.append(E);E.setStyle("bottom",0);E.setStyle("left",1);E.setStyle("position","absolute");E.setStyle("z-index",this.get("contentZIndex"));E.append(C);H=new B.Node.create('<div class="'+F+'-clone-edit" />');C.append(H);B.on("click",B.bind(this._onClickEdit,this),H);I=new B.Node.create('<div class="'+F+'-clone-remove" />');C.append(I);B.on("click",B.bind(this._onClickRemove,this),I);this._refreshCloneNode();return E;},_attachEditor:function(){var M=this.get("host"),G=this.get("baseNode"),D=this.get("parentNode"),L=this.get("designerClass")+"-sources",K=this.get("designerClass")+"-edit-panel",Q=G.one("div."+L),J=G.one("div."+K),P=D.layoutDesignerPlaces,F=P.get("placesType"),I=this.get("contentType")==="image"?B.Bewype.EditorTag:B.Bewype.EditorText,E=this.get("contentType")==="image"?"editorImageButtons":"editorTextButtons",H=null,O=null,N=(F==="vertical")?P.get("parentNode"):null,C=N?N.layoutDesignerPlaces:null;Q.setStyle("display","none");J.setStyle("display","block");if(F==="vertical"){O=D.layoutDesignerPlaces.getMaxWidth();O+=C?C.getAvailablePlace():0;}else{O=D.layoutDesignerPlaces.getAvailablePlace();O+=this.getContentWidth();}H={panelNode:J,spinnerMaxWidth:O,activeButtons:this.get(E)};M.plug(I,H);B.on("bewype-editor:onClose",B.bind(this._detachEditor,this),M);B.on("bewype-editor:onChange",B.bind(this.refresh,this),M);this.editing=true;},_detachEditor:function(){var F=this.get("host"),E=this.get("baseNode"),I=this.get("designerClass")+"-sources",D=this.get("designerClass")+"-edit-panel",H=E.one("div."+I),C=E.one("div."+D),G=this.get("contentType")==="image"?B.Bewype.EditorTag:B.Bewype.EditorText;this.editing=false;if(C&&C.bewypeEditorPanel){C.unplug(B.Bewype.EditorPanel);F.unplug(G);F.detachAll("bewype-editor:onClose");F.detachAll("bewype-editor:onChange");this.refresh();}if(C){C.setStyle("display","none");}if(H){H.setStyle("display","block");}this._refreshCloneNode();return true;},_onClickEdit:function(C){var D=this.get("parentNode");B.each(D.layoutDesignerPlaces.getContents(),function(F,E){F.layoutDesignerContent._detachEditor();});this._attachEditor();},_onClickRemove:function(C){var D=this.get("host"),E=this.get("parentNode");E.layoutDesignerPlaces.removeContent(D);},_onMouseEnter:function(C){if(this.editing){return;}var E=this.get("parentNode"),D=this.getCloneNode();E.layoutDesignerPlaces.cleanContentOver();if(D){B.each(D.all("div"),function(G,F){G.setStyle("visibility","visible");});D.setStyle("visibility","visible");}else{D=this._addCloneNode();}this._q.stop();this._q.add({fn:function(){},timeout:1000},{fn:this.hideClone,args:[D]});this._q.run();},getContentHeight:function(){var D=this.get("host"),C=B.Bewype.Utils.getHeight(D),F=B.Bewype.Utils.getStyleValue(D,"paddingTop")||0,E=B.Bewype.Utils.getStyleValue(D,"paddingBottom")||0;return C+F+E+2;},getContentWidth:function(){var E=this.get("host"),F=B.Bewype.Utils.getWidth(E),D=B.Bewype.Utils.getStyleValue(E,"paddingRight")||0,C=B.Bewype.Utils.getStyleValue(E,"paddingLeft")||0;return F+C+D+2;},_refreshCloneNode:function(E){var D=this.getCloneNode(),F=this.getContentHeight(),C=E||this.getContentWidth();if(D){D.setStyle("height",F-2);D.setStyle("width",C-2);}},refresh:function(E){var F=this.get("parentNode"),D=this.get("host"),C=null;if(E){C=this.getContentWidth();C=C>E?E:C;D.setStyle("width",C);D.setStyle("paddingLeft",0);D.setStyle("paddingRight",0);}this._refreshCloneNode(E);}});B.namespace("Bewype");B.Bewype.LayoutDesignerContent=A;},"@VERSION@",{requires:["async-queue","plugin","substitute","bewype-layout-designer-config","bewype-editor"]});