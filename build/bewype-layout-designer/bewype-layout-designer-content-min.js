YUI.add("bewype-layout-designer-content",function(b){var a=function(c){a.superclass.constructor.apply(this,arguments);};a.C_TEMPLATE='<div class="{designerClass}-content">{defaultContent}</div>';a.NAME="layout-designer-content";a.NS="layoutDesignerContent";a.ATTRS={designerClass:{value:"layout-designer",writeOnce:true,validator:function(c){return b.Lang.isString(c);}},contentHeight:{value:40,validator:function(c){return b.Lang.isNumber(c);}},contentWidth:{value:140,validator:function(c){return b.Lang.isNumber(c);}},contentZIndex:{value:1,validator:function(c){return b.Lang.isNumber(c);}},defaultContent:{value:"Text..",validator:function(c){return b.Lang.isString(c);}},baseNode:{value:null,writeOnce:true},parentNode:{value:null}};b.extend(a,b.Plugin.Base,{_q:null,editing:false,initializer:function(c){var d=this.get("host"),f=this.get("parentNode"),e=null;e=new b.Node.create(b.substitute(a.C_TEMPLATE,{designerClass:this.get("designerClass")}));d.append(e);e.setStyle("height",this.get("contentHeight"));e.setStyle("width",this.get("contentWidth"));e.set("innerHTML",this.get("defaultContent"));b.on("mouseenter",b.bind(this._onMouseEnter,this),d);f.layoutDesignerPlaces.registerContent(d);this._q=new b.AsyncQueue();},destructor:function(){var d=this.get("host"),f=this.get("parentNode"),c=this.get("designerClass")+"-content",e=d.one("div."+c),e=d.one("div."+c+"-clone");this._detachEditor();f.layoutDesignerPlaces.unRegisterContent(d);b.detach(d);if(e){b.Event.purgeElement(e,true);e.remove();}d.remove();},_detachEditor:function(){var g=this.get("host"),e=this.get("baseNode"),j=this.get("designerClass")+"-sources",d=this.get("designerClass")+"-edit-panel",f=this.get("designerClass")+"-content",i=e.one("div."+j),c=e.one("div."+d),h=g.one("div."+f);g.detachAll("bewype-editor:onClose");g.detachAll("bewype-editor:onChange");this.editing=false;this.refresh();if(h.bewypeEditor){h.unplug(b.Bewype.Editor);}c.setStyle("display","none");i.setStyle("display","block");},_attachEditor:function(){var l=this.get("host"),e=this.get("baseNode"),c=this.get("parentNode"),k=this.get("designerClass")+"-sources",j=this.get("designerClass")+"-edit-panel",d=this.get("designerClass")+"-content",n=e.one("div."+k),h=e.one("div."+j),i=c.layoutDesignerPlaces.getAvailablePlace(),g=l.one("div."+d),f=null,m=null;n.setStyle("display","none");h.setStyle("display","block");if(i){m=i;m+=this.getContentWidth();f={panelNode:h,spinnerMaxWidth:m};}else{f={panelNode:h};}g.plug(b.Bewype.Editor,f);this.editing=true;b.on("bewype-editor:onClose",b.bind(this._detachEditor,this),g);b.on("bewype-editor:onChange",b.bind(this.refresh,this),g);},_onClickEdit:function(c){var d=this.get("parentNode");b.each(d.layoutDesignerPlaces.getContents(),function(f,e){f.layoutDesignerContent._detachEditor();});this._attachEditor();},_onClickRemove:function(c){var d=this.get("host"),e=this.get("parentNode");e.layoutDesignerPlaces.removeContent(d);},hideClone:function(c){if(!c){var e=this.get("host"),d=this.get("designerClass")+"-content";c=e.one("div."+d+"-clone");}if(c){b.each(c.all("div"),function(g,f){g.setStyle("visibility","hidden");});c.setStyle("visibility","hidden");}},_addCloneNode:function(){var f=this.get("host"),e=this.get("designerClass")+"-content",c=new b.Node.create('<div class="'+e+'-clone-callbacks" />'),d=null,g=null,h=null;d=f.cloneNode(false);d.set("innerHTML","");d.set("className",e+"-clone");f.append(d);d.setStyle("z-index",this.get("contentZIndex"));d.setStyle("position","absolute");d.setStyle("bottom",0);d.append(c);g=new b.Node.create('<div class="'+e+'-clone-edit" />');c.append(g);b.on("click",b.bind(this._onClickEdit,this),g);h=new b.Node.create('<div class="'+e+'-clone-remove" />');c.append(h);b.on("click",b.bind(this._onClickRemove,this),h);this._refreshCloneNode();return d;},_onMouseEnter:function(c){if(this.editing){return;}var e=this.get("host"),g=this.get("parentNode"),d=this.get("designerClass")+"-content",f=e.one("div."+d+"-clone");g.layoutDesignerPlaces.cleanContentOver();if(f){b.each(f.all("div"),function(i,h){i.setStyle("visibility","visible");});f.setStyle("visibility","visible");}else{f=this._addCloneNode();}this._q.stop();this._q.add({fn:function(){},timeout:1000},{fn:this.hideClone,args:[f]});this._q.run();},getContentHeight:function(){var e=this.get("host"),d=this.get("designerClass")+"-content",g=e.one("div."+d),c=b.Bewype.Utils.getHeight(g),f=b.Bewype.Utils.getStyleValue(g,"paddingTop")||0;return c+f;},getContentWidth:function(){var e=this.get("host"),d=this.get("designerClass")+"-content",g=e.one("div."+d),f=b.Bewype.Utils.getWidth(g),c=b.Bewype.Utils.getStyleValue(g,"paddingLeft")||0;return f+c;},_refreshCloneNode:function(){var f=this.get("host"),e=this.get("designerClass")+"-content",d=f.one("div."+e+"-clone"),g=this.getContentHeight(),c=this.getContentWidth();if(d){d.setStyle("height",g);d.setStyle("width",c);}},refresh:function(){this._refreshCloneNode();var c=this.get("parentNode");c.layoutDesignerTarget.refresh();}});b.namespace("Bewype");b.Bewype.LayoutDesignerContent=a;},"@VERSION@",{requires:["async-queue","plugin","substitute","bewype-editor"]});