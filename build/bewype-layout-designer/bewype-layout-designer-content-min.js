YUI.add("bewype-layout-designer-content",function(B){var A=function(C){A.superclass.constructor.apply(this,arguments);};A.C_TEXT_TEMPLATE='<div class="{designerClass}-content ';A.C_TEXT_TEMPLATE+='{designerClass}-content-{contentType}">';A.C_TEXT_TEMPLATE+="{defaultContent}</div>";A.C_IMG_TEMPLATE='<div class="{designerClass}-content ';A.C_IMG_TEMPLATE+='{designerClass}-content-{contentType}">';A.C_IMG_TEMPLATE+='<img src="{defaultContent}" />';A.C_IMG_TEMPLATE+="</div>";A.NAME="layout-designer-content";A.NS="layoutDesignerContent";B.extend(A,B.Bewype.LayoutDesignerConfig,{initializer:function(C){this.setAttrs(C);var E=this.get("host"),I=this.get("parentNode"),G=this.get("contentType"),D=this.get("designerClass"),H=G==="text"?E.one("div"):E.one("img"),F=G==="text"?A.C_TEXT_TEMPLATE:A.C_IMG_TEMPLATE;if(!H){H=new B.Node.create(B.substitute(F,{designerClass:D,contentType:G,defaultContent:G==="text"?this.get("defaultText"):this.get("defaultImg")}));E.append(H);H.setStyle("height",this.get("contentHeight"));H.setStyle("width",this.get("contentWidth"));}this._addCloneNode();},destructor:function(){var E=this.get("host"),D=this.get("designerClass")+"-content",C=E.one("."+D+"-clone");if(C){C.one("."+D+"-clone-edit").detachAll("click");C.one("."+D+"-clone-remove").detachAll("click");C.remove();}},_detachEditor:function(){var G=this.get("host"),E=this.get("baseNode"),D=this.get("designerClass")+"-edit-panel",C=E.one("div."+D),I=this.get("contentType")==="image"?B.Bewype.EditorTag:B.Bewype.EditorText,H=this.getContentNode(),F=this.getCloneNode();if(C&&C.bewypeEditorPanel){C.unplug(B.Bewype.EditorPanel);H.unplug(I);G.detachAll("bewype-editor:onClose");G.detachAll("bewype-editor:onChange");this.refresh();}if(C){C.setStyle("display","none");}if(F){F.setStyle("display","block");}this._refreshCloneNode();return true;},_attachEditor:function(){var G=this.get("baseNode"),D=this.get("parentNode"),M=this.get("designerClass")+"-edit-panel",L=G.one("div."+M),P=D.layoutDesignerPlaces,F=P.get("placesType"),J=this.get("contentType")==="image"?B.Bewype.EditorTag:B.Bewype.EditorText,E=this.get("contentType")==="image"?"editorImageButtons":"editorTextButtons",K=this.getContentNode(),I=this.getCloneNode(),H=null,O=null,N=(F==="vertical")?P.get("parentNode"):null,C=N?N.layoutDesignerPlaces:null;I.setStyle("display","none");L.setStyle("display","block");if(F==="vertical"){O=D.layoutDesignerPlaces.getMaxWidth();O+=C?C.getAvailablePlace():0;}else{O=D.layoutDesignerPlaces.getAvailablePlace();O+=this.getContentWidth();}H={panelNode:L,spinnerMaxWidth:O,activeButtons:this.get(E),fileStaticPath:this.get("fileStaticPath"),uploadUrl:this.get("uploadUrl")};K.plug(J,H);B.on("bewype-editor:onClose",B.bind(this._detachEditor,this),K);B.on("bewype-editor:onChange",B.bind(this.refresh,this),K);},_onClickEdit:function(C){var D=this.get("parentNode");B.each(D.layoutDesignerPlaces.getContents(),function(F,E){F.layoutDesignerContent._detachEditor();});this._attachEditor();},_onClickRemove:function(C){var D=this.get("host"),E=this.get("parentNode");E.layoutDesignerPlaces.removeContent(D);},_addCloneNode:function(){var F=this.get("host"),E=this.get("designerClass")+"-content",C=new B.Node.create('<div class="'+E+'-clone-callbacks" />'),D=null,I=null,G=null,H=null;D=F.cloneNode(false);D.set("innerHTML","");D.set("className",E+"-clone");F.append(D);D.setStyle("z-index",this.get("contentZIndex"));D.setStyle("position","absolute");D.setStyle("bottom",0);D.append(C);I=new B.Node.create('<div class="'+E+'-clone-drag" />');C.append(I);G=new B.Node.create('<div class="'+E+'-clone-edit" />');C.append(G);B.on("click",B.bind(this._onClickEdit,this),G);H=new B.Node.create('<div class="'+E+'-clone-remove" />');C.append(H);B.on("click",B.bind(this._onClickRemove,this),H);this._refreshCloneNode();},getContentHeight:function(){var F=this.getContentNode(),C=B.Bewype.Utils.getHeight(F),E=B.Bewype.Utils.getStyleValue(F,"paddingTop")||0,D=B.Bewype.Utils.getStyleValue(F,"paddingBottom")||0;return C+E+D;},getContentWidth:function(){var F=this.getContentNode(),E=B.Bewype.Utils.getWidth(F),D=B.Bewype.Utils.getStyleValue(F,"paddingRight")||0,C=B.Bewype.Utils.getStyleValue(F,"paddingLeft")||0;return E+C+D;},getContentNode:function(){var D=this.get("host"),C=this.get("designerClass")+"-content";return D.one("div."+C);},getCloneNode:function(){var D=this.get("host"),C=this.get("designerClass")+"-content",E="div."+C+"-clone";return D.one(E);},_refreshCloneNode:function(E){var D=this.getCloneNode(),F=this.getContentHeight(),C=E||this.getContentWidth();if(D){D.setStyle("height",F-2);D.setStyle("width",C-2);}},refresh:function(C){var E=this.get("parentNode"),D=C?this.getContentNode():null;if(D){D.setStyle("width",C);D.setStyle("paddingLeft",0);D.setStyle("paddingRight",0);}this._refreshCloneNode(C);E.layoutDesignerTarget.refresh();}});B.namespace("Bewype");B.Bewype.LayoutDesignerContent=A;},"@VERSION@",{requires:["async-queue","plugin","substitute","bewype-editor"]});