YUI.add("bewype-layout-designer-content",function(b){var a=function(c){a.superclass.constructor.apply(this,arguments);};a.C_TEXT_TEMPLATE='<div class="{designerClass}-content ';a.C_TEXT_TEMPLATE+='{designerClass}-content-{contentType}">';a.C_TEXT_TEMPLATE+="{defaultContent}</div>";a.C_IMG_TEMPLATE='<div class="{designerClass}-content ';a.C_IMG_TEMPLATE+='{designerClass}-content-{contentType}">';a.C_IMG_TEMPLATE+='<img src="{defaultContent}" />';a.C_IMG_TEMPLATE+="</div>";a.NAME="layout-designer-content";a.NS="layoutDesignerContent";b.extend(a,b.Bewype.LayoutDesignerConfig,{initializer:function(c){this.setAttrs(c);var e=this.get("host"),i=this.get("parentNode"),g=this.get("contentType"),d=this.get("designerClass"),h=g==="text"?e.one("div"):e.one("img"),f=g==="text"?a.C_TEXT_TEMPLATE:a.C_IMG_TEMPLATE;if(!h){h=new b.Node.create(b.substitute(f,{designerClass:d,contentType:g,defaultContent:g==="text"?this.get("defaultText"):this.get("defaultImg")}));e.append(h);h.setStyle("height",this.get("contentHeight"));h.setStyle("width",this.get("contentWidth"));}this._addCloneNode();},destructor:function(){var e=this.get("host"),d=this.get("designerClass")+"-content",c=e.one("."+d+"-clone");if(c){c.one("."+d+"-clone-edit").detachAll("click");c.one("."+d+"-clone-remove").detachAll("click");c.remove();}},_detachEditor:function(){var g=this.get("host"),e=this.get("baseNode"),d=this.get("designerClass")+"-edit-panel",c=e.one("div."+d),i=this.get("contentType")==="image"?b.Bewype.EditorTag:b.Bewype.EditorText,h=this.getContentNode(),f=this.getCloneNode();if(c&&c.bewypeEditorPanel){c.unplug(b.Bewype.EditorPanel);h.unplug(i);g.detachAll("bewype-editor:onClose");g.detachAll("bewype-editor:onChange");this.refresh();}if(c){c.setStyle("display","none");}if(f){f.setStyle("display","block");}this._refreshCloneNode();return true;},_attachEditor:function(){var g=this.get("baseNode"),d=this.get("parentNode"),m=this.get("designerClass")+"-edit-panel",l=g.one("div."+m),p=d.layoutDesignerPlaces,f=p.get("placesType"),j=this.get("contentType")==="image"?b.Bewype.EditorTag:b.Bewype.EditorText,e=this.get("contentType")==="image"?"editorImageButtons":"editorTextButtons",k=this.getContentNode(),i=this.getCloneNode(),h=null,o=null,n=(f==="vertical")?p.get("parentNode"):null,c=n?n.layoutDesignerPlaces:null;i.setStyle("display","none");l.setStyle("display","block");if(f==="vertical"){o=d.layoutDesignerPlaces.getMaxWidth();o+=c?c.getAvailablePlace():0;}else{o=d.layoutDesignerPlaces.getAvailablePlace();o+=this.getContentWidth();}h={panelNode:l,spinnerMaxWidth:o,activeButtons:this.get(e),fileStaticPath:this.get("fileStaticPath"),uploadUrl:this.get("uploadUrl"),panelPosition:this.get("panelPosition"),panelOffsetY:this.get("panelOffsetY"),panelOffsetX:this.get("panelOffsetX"),pickerColorSize:this.get("pickerColorSize")};k.plug(j,h);b.on("bewype-editor:onClose",b.bind(this._detachEditor,this),k);b.on("bewype-editor:onChange",b.bind(this.refresh,this),k);},_onClickEdit:function(c){var d=this.get("parentNode");b.each(d.layoutDesignerPlaces.getContents(),function(f,e){f.layoutDesignerContent._detachEditor();});this._attachEditor();},_onClickRemove:function(c){var d=this.get("host"),e=this.get("parentNode");e.layoutDesignerPlaces.removeContent(d);},_addCloneNode:function(){var f=this.get("host"),e=this.get("designerClass")+"-content",c=new b.Node.create('<div class="'+e+'-clone-callbacks" />'),d=null,i=null,g=null,h=null;d=f.cloneNode(false);d.set("innerHTML","");d.set("className",e+"-clone");f.append(d);d.setStyle("z-index",this.get("contentZIndex"));d.setStyle("position","absolute");d.setStyle("bottom",0);d.append(c);i=new b.Node.create('<div class="'+e+'-clone-drag" />');c.append(i);g=new b.Node.create('<div class="'+e+'-clone-edit" />');c.append(g);b.on("click",b.bind(this._onClickEdit,this),g);h=new b.Node.create('<div class="'+e+'-clone-remove" />');c.append(h);b.on("click",b.bind(this._onClickRemove,this),h);this._refreshCloneNode();},getContentHeight:function(){var f=this.getContentNode(),c=b.Bewype.Utils.getHeight(f),e=b.Bewype.Utils.getStyleValue(f,"paddingTop")||0,d=b.Bewype.Utils.getStyleValue(f,"paddingBottom")||0;return c+e+d;},getContentWidth:function(){var f=this.getContentNode(),e=b.Bewype.Utils.getWidth(f),d=b.Bewype.Utils.getStyleValue(f,"paddingRight")||0,c=b.Bewype.Utils.getStyleValue(f,"paddingLeft")||0;return e+c+d;},getContentNode:function(){var d=this.get("host"),c=this.get("designerClass")+"-content";return d.one("div."+c);},getCloneNode:function(){var d=this.get("host"),c=this.get("designerClass")+"-content",e="div."+c+"-clone";return d.one(e);},_refreshCloneNode:function(e){var d=this.getCloneNode(),f=this.getContentHeight(),c=e||this.getContentWidth();if(d){d.setStyle("height",f-2);d.setStyle("width",c-2);}},refresh:function(c){var e=this.get("parentNode"),d=c?this.getContentNode():null;if(d){d.setStyle("width",c);d.setStyle("paddingLeft",0);d.setStyle("paddingRight",0);}this._refreshCloneNode(c);e.layoutDesignerTarget.refresh();}});b.namespace("Bewype");b.Bewype.LayoutDesignerContent=a;},"@VERSION@",{requires:["async-queue","plugin","substitute","bewype-editor"]});