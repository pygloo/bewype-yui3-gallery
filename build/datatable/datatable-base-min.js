YUI.add("datatable-base",function(c){var w=c.Lang,g=w.isValue,F=c.Lang.substitute,d=c.Node,t=d.create,p=c.ClassNameManager.getClassName,q="datatable",r="column",H="focus",K="keydown",h="mouseenter",o="mouseleave",k="mouseup",z="mousedown",C="click",v="dblclick",e=p(q,"columns"),B=p(q,"data"),b=p(q,"msg"),l=p(q,"liner"),E=p(q,"first"),i=p(q,"last"),u=p(q,"even"),A=p(q,"odd"),D="<table></table>",x="<col></col>",I='<thead class="'+e+'"></thead>',f='<tbody class="'+B+'"></tbody>',J='<th id="{id}" rowspan="{rowspan}" colspan="{colspan}" class="{classnames}"><div class="'+l+'">{value}</div></th>',G='<tr id="{id}"></tr>',a='<td headers="{headers}" class="{classnames}"><div class="'+l+'">{value}</div></td>',j="{value}",n='<tbody class="'+b+'"></tbody>';function m(L){m.superclass.constructor.apply(this,arguments);}c.mix(m,{NAME:"column",ATTRS:{id:{valueFn:"_defaultId",writeOnce:true},key:{valueFn:"_defaultKey"},field:{valueFn:"_defaultField"},label:{valueFn:"_defaultLabel"},children:{value:null},abbr:{value:null},classnames:{readOnly:true,getter:"_getClassnames"},formatter:{},sortable:{value:false},editor:{},width:{},resizeable:{},minimized:{},minWidth:{},maxAutoWidth:{}}});c.extend(m,c.Widget,{_defaultId:function(){return c.guid();},_defaultKey:function(L){return L||c.guid();},_defaultField:function(L){return L||this.get("key");},_defaultLabel:function(L){return L||this.get("key");},_afterAbbrChange:function(L){this._uiSetAbbr(L.newVal);},keyIndex:null,headers:null,colSpan:1,rowSpan:1,parent:null,thNode:null,initializer:function(L){},destructor:function(){},_getClassnames:function(){return c.ClassNameManager.getClassName(r,this.get("id"));},syncUI:function(){this._uiSetAbbr(this.get("abbr"));},_uiSetAbbr:function(L){this.thNode.set("abbr",L);}});c.Column=m;function y(L){y.superclass.constructor.apply(this,arguments);}c.mix(y,{NAME:"columnset",ATTRS:{definitions:{setter:"_setDefinitions"}}});c.extend(y,c.Base,{_setDefinitions:function(L){return c.clone(L);},tree:null,idHash:null,keyHash:null,keys:null,initializer:function(){var L=[],Q={},R={},P=[],O=this.get("definitions"),M=this;function N(Z,Y,X){var U=0,T=Y.length,W,V,S;Z++;if(!L[Z]){L[Z]=[];}for(;U<T;++U){W=Y[U];W=w.isString(W)?{key:W}:W;V=new c.Column(W);W.yuiColumnId=V.get("id");Q[V.get("id")]=V;R[V.get("key")]=V;if(X){V.parent=X;}if(w.isArray(W.children)){S=W.children;V._set("children",S);M._setColSpans(V,W);M._cascadePropertiesToChildren(V,S);if(!L[Z+1]){L[Z+1]=[];}N(Z,S,V);}else{V.keyIndex=P.length;P.push(V);}L[Z].push(V);}Z--;}N(-1,O);this.tree=L;this.idHash=Q;this.keyHash=R;this.keys=P;this._setRowSpans();this._setHeaders();},destructor:function(){},_cascadePropertiesToChildren:function(O,M){var N=0,L=M.length,P;for(;N<L;++N){P=M[N];if(O.get("className")&&(P.className===undefined)){P.className=O.get("className");}if(O.get("editor")&&(P.editor===undefined)){P.editor=O.get("editor");}if(O.get("formatter")&&(P.formatter===undefined)){P.formatter=O.get("formatter");}if(O.get("resizeable")&&(P.resizeable===undefined)){P.resizeable=O.get("resizeable");}if(O.get("sortable")&&(P.sortable===undefined)){P.sortable=O.get("sortable");}if(O.get("hidden")){P.hidden=true;}if(O.get("width")&&(P.width===undefined)){P.width=O.get("width");}if(O.get("minWidth")&&(P.minWidth===undefined)){P.minWidth=O.get("minWidth");}if(O.get("maxAutoWidth")&&(P.maxAutoWidth===undefined)){P.maxAutoWidth=O.get("maxAutoWidth");}}},_setColSpans:function(N,M){var O=0;function L(R){var S=R.children,Q=0,P=S.length;for(;Q<P;++Q){if(w.isArray(S[Q].children)){L(S[Q]);}else{O++;}}}L(M);N.colSpan=O;},_setRowSpans:function(){function L(N){var O=1,Q,P,M,S;function R(X,W){W=W||1;var V=0,T=X.length,U;for(;V<T;++V){U=X[V];if(w.isArray(U.children)){W++;R(U.children,W);W--;}else{if(U.get&&w.isArray(U.get("children"))){W++;R(U.get("children"),W);W--;}else{if(W>O){O=W;}}}}}for(M=0;M<N.length;M++){Q=N[M];R(Q);for(S=0;S<Q.length;S++){P=Q[S];if(!w.isArray(P.get("children"))){P.rowSpan=O;}}O=1;}}L(this.tree);},_setHeaders:function(){var Q,O,N=this.keys,M=0,L=N.length;function P(S,R){S.push(R.get("key"));if(R.parent){P(S,R.parent);}}for(;M<L;++M){Q=[];O=N[M];P(Q,O);O.headers=Q.reverse().join(" ");}},getColumn:function(){}});c.Columnset=y;function s(L){s.superclass.constructor.apply(this,arguments);}c.mix(s,{NAME:"dataTable",ATTRS:{columnset:{setter:"_setColumnset"},recordset:{value:new c.Recordset({records:[]}),setter:"_setRecordset"},summary:{},caption:{},thValueTemplate:{value:j},tdValueTemplate:{value:j},trTemplate:{value:G}},HTML_PARSER:{}});c.extend(s,c.Widget,{thTemplate:J,tdTemplate:a,_theadNode:null,_tbodyNode:null,_msgNode:null,_setColumnset:function(L){return w.isArray(L)?new c.Columnset({definitions:L}):L;},_afterColumnsetChange:function(L){if(this.get("rendered")){this._uiSetColumnset(L.newVal);}},_setRecordset:function(L){if(w.isArray(L)){L=new c.Recordset({records:L});}L.addTarget(this);return L;},_afterRecordsetChange:function(L){if(this.get("rendered")){this._uiSetRecordset(L.newVal);}},_afterSummaryChange:function(L){if(this.get("rendered")){this._uiSetSummary(L.newVal);}},_afterCaptionChange:function(L){if(this.get("rendered")){this._uiSetCaption(L.newVal);}},initializer:function(L){this.after("columnsetChange",this._afterColumnsetChange);this.after("recordsetChange",this._afterRecordsetChange);this.after("summaryChange",this._afterSummaryChange);this.after("captionChange",this._afterCaptionChange);},destructor:function(){this.get("recordset").removeTarget(this);},renderUI:function(){return(this._addTableNode(this.get("contentBox"))&&this._addColgroupNode(this._tableNode)&&this._addTheadNode(this._tableNode)&&this._addTbodyNode(this._tableNode)&&this._addMessageNode(this._tableNode)&&this._addCaptionNode(this._tableNode));},_addTableNode:function(L){if(!this._tableNode){this._tableNode=L.appendChild(t(D));}return this._tableNode;},_addColgroupNode:function(N){var L=this.get("columnset").keys.length,M=0,O=["<colgroup>"];for(;M<L;++M){O.push(x);}O.push("</colgroup>");this._colgroupNode=N.insertBefore(t(O.join("")),N.get("firstChild"));
return this._colgroupNode;},_addTheadNode:function(L){if(L){this._theadNode=L.insertBefore(t(I),this._colgroupNode.next());return this._theadNode;}},_addTbodyNode:function(L){this._tbodyNode=L.appendChild(t(f));return this._tbodyNode;},_addMessageNode:function(L){this._msgNode=L.insertBefore(t(n),this._tbodyNode);return this._msgNode;},_addCaptionNode:function(L){this._captionNode=L.createCaption();return this._captionNode;},bindUI:function(){var P=this._tableNode,M=this.get("contentBox"),N="thead."+e+">tr>th",O="tbody."+B+">tr>td",L="tbody."+b+">tr>td";this.publish("theadCellFocus",{defaultFn:this._defTheadCellFocusFn,emitFacade:false,queuable:true});this.publish("theadRowFocus",{defaultFn:this._defTheadRowFocusFn,emitFacade:false,queuable:true});this.publish("theadFocus",{defaultFn:this._defTheadFocusFn,emitFacade:false,queuable:true});this.publish("tbodyCellFocus",{defaultFn:this._defTbodyCellFocusFn,emitFacade:false,queuable:true});this.publish("tbodyRowFocus",{defaultFn:this._defTbodyRowFocusFn,emitFacade:false,queuable:true});this.publish("tbodyFocus",{defaultFn:this._defTbodyFocusFn,emitFacade:false,queuable:true});this.publish("msgCellFocus",{defaultFn:this._defMsgCellFocusFn,emitFacade:false,queuable:true});this.publish("msgRowFocus",{defaultFn:this._defMsgRowFocusFn,emitFacade:false,queuable:true});this.publish("msgTbodyFocus",{defaultFn:this._defMsgTbodyFocusFn,emitFacade:false,queuable:true});this.publish("theadCellKeydown",{defaultFn:this._defTheadCellKeydownFn,emitFacade:false,queuable:true});this.publish("theadRowKeydown",{defaultFn:this._defTheadRowKeydownFn,emitFacade:false,queuable:true});this.publish("theadKeydown",{defaultFn:this._defTheadKeydownFn,emitFacade:false,queuable:true});this.publish("tbodyCellKeydown",{defaultFn:this._defTbodyCellKeydownFn,emitFacade:false,queuable:true});this.publish("tbodyRowKeydown",{defaultFn:this._defTbodyRowKeydownFn,emitFacade:false,queuable:true});this.publish("tbodyKeydown",{defaultFn:this._defTbodyKeydownFn,emitFacade:false,queuable:true});this.publish("msgCellKeydown",{defaultFn:this._defMsgCellKeydownFn,emitFacade:false,queuable:true});this.publish("msgRowKeydown",{defaultFn:this._defMsgRowKeydownFn,emitFacade:false,queuable:true});this.publish("msgTbodyKeydown",{defaultFn:this._defMsgTbodyKeydownFn,emitFacade:false,queuable:true});this.publish("theadCellMouseenter",{defaultFn:this._defTheadCellMouseenterFn,emitFacade:false,queuable:true});this.publish("theadRowMouseenter",{defaultFn:this._defTheadRowMouseenterFn,emitFacade:false,queuable:true});this.publish("theadMouseenter",{defaultFn:this._defTheadMouseenterFn,emitFacade:false,queuable:true});this.publish("tbodyCellMouseenter",{defaultFn:this._defTbodyCellMouseenterFn,emitFacade:false,queuable:true});this.publish("tbodyRowMouseenter",{defaultFn:this._defTbodyRowMouseenterFn,emitFacade:false,queuable:true});this.publish("tbodyMouseenter",{defaultFn:this._defTbodyMouseenterFn,emitFacade:false,queuable:true});this.publish("msgCellMouseenter",{defaultFn:this._defMsgCellMouseenterFn,emitFacade:false,queuable:true});this.publish("msgRowMouseenter",{defaultFn:this._defMsgRowMouseenterFn,emitFacade:false,queuable:true});this.publish("msgTbodyMouseenter",{defaultFn:this._defMsgTbodyMouseenterFn,emitFacade:false,queuable:true});this.publish("theadCellMouseleave",{defaultFn:this._defTheadCellMouseleaveFn,emitFacade:false,queuable:true});this.publish("theadRowMouseleave",{defaultFn:this._defTheadRowMouseleaveFn,emitFacade:false,queuable:true});this.publish("theadMouseleave",{defaultFn:this._defTheadMouseleaveFn,emitFacade:false,queuable:true});this.publish("tbodyCellMouseleave",{defaultFn:this._defTbodyCellMouseleaveFn,emitFacade:false,queuable:true});this.publish("tbodyRowMouseleave",{defaultFn:this._defTbodyRowMouseleaveFn,emitFacade:false,queuable:true});this.publish("tbodyMouseleave",{defaultFn:this._defTbodyMouseleaveFn,emitFacade:false,queuable:true});this.publish("msgCellMouseleave",{defaultFn:this._defMsgCellMouseleaveFn,emitFacade:false,queuable:true});this.publish("msgRowMouseleave",{defaultFn:this._defMsgRowMouseleaveFn,emitFacade:false,queuable:true});this.publish("msgTbodyMouseleave",{defaultFn:this._defMsgTbodyMouseleaveFn,emitFacade:false,queuable:true});this.publish("theadCellMouseup",{defaultFn:this._defTheadCellMouseupFn,emitFacade:false,queuable:true});this.publish("theadRowMouseup",{defaultFn:this._defTheadRowMouseupFn,emitFacade:false,queuable:true});this.publish("theadMouseup",{defaultFn:this._defTheadMouseupFn,emitFacade:false,queuable:true});this.publish("tbodyCellMouseup",{defaultFn:this._defTbodyCellMouseupFn,emitFacade:false,queuable:true});this.publish("tbodyRowMouseup",{defaultFn:this._defTbodyRowMouseupFn,emitFacade:false,queuable:true});this.publish("tbodyMouseup",{defaultFn:this._defTbodyMouseupFn,emitFacade:false,queuable:true});this.publish("msgCellMouseup",{defaultFn:this._defMsgCellMouseupFn,emitFacade:false,queuable:true});this.publish("msgRowMouseup",{defaultFn:this._defMsgRowMouseupFn,emitFacade:false,queuable:true});this.publish("msgTbodyMouseup",{defaultFn:this._defMsgTbodyMouseupFn,emitFacade:false,queuable:true});this.publish("theadCellMousedown",{defaultFn:this._defTheadCellMousedownFn,emitFacade:false,queuable:true});this.publish("theadRowMousedown",{defaultFn:this._defTheadRowMousedownFn,emitFacade:false,queuable:true});this.publish("theadMousedown",{defaultFn:this._defTheadMousedownFn,emitFacade:false,queuable:true});this.publish("tbodyCellMousedown",{defaultFn:this._defTbodyCellMousedownFn,emitFacade:false,queuable:true});this.publish("tbodyRowMousedown",{defaultFn:this._defTbodyRowMousedownFn,emitFacade:false,queuable:true});this.publish("tbodyMousedown",{defaultFn:this._defTbodyMousedownFn,emitFacade:false,queuable:true});this.publish("msgCellMousedown",{defaultFn:this._defMsgCellMousedownFn,emitFacade:false,queuable:true});this.publish("msgRowMousedown",{defaultFn:this._defMsgRowMousedownFn,emitFacade:false,queuable:true});this.publish("msgTbodyMousedown",{defaultFn:this._defMsgTbodyMousedownFn,emitFacade:false,queuable:true});
this.publish("theadCellClick",{defaultFn:this._defTheadCellClickFn,emitFacade:false,queuable:true});this.publish("theadRowClick",{defaultFn:this._defTheadRowClickFn,emitFacade:false,queuable:true});this.publish("theadClick",{defaultFn:this._defTheadClickFn,emitFacade:false,queuable:true});this.publish("tbodyCellClick",{defaultFn:this._defTbodyCellClickFn,emitFacade:false,queuable:true});this.publish("tbodyRowClick",{defaultFn:this._defTbodyRowClickFn,emitFacade:false,queuable:true});this.publish("tbodyClick",{defaultFn:this._defTbodyClickFn,emitFacade:false,queuable:true});this.publish("msgCellClick",{defaultFn:this._defMsgCellClickFn,emitFacade:false,queuable:true});this.publish("msgRowClick",{defaultFn:this._defMsgRowClickFn,emitFacade:false,queuable:true});this.publish("msgTbodyClick",{defaultFn:this._defMsgTbodyClickFn,emitFacade:false,queuable:true});this.publish("theadCellDblclick",{defaultFn:this._defTheadCellDblclickFn,emitFacade:false,queuable:true});this.publish("theadRowDblclick",{defaultFn:this._defTheadRowDblclickFn,emitFacade:false,queuable:true});this.publish("theadDblclick",{defaultFn:this._defTheadDblclickFn,emitFacade:false,queuable:true});this.publish("tbodyCellDblclick",{defaultFn:this._defTbodyCellDblclickFn,emitFacade:false,queuable:true});this.publish("tbodyRowDblclick",{defaultFn:this._defTbodyRowDblclickFn,emitFacade:false,queuable:true});this.publish("tbodyDblclick",{defaultFn:this._defTbodyDblclickFn,emitFacade:false,queuable:true});this.publish("msgCellDblclick",{defaultFn:this._defMsgCellDblclickFn,emitFacade:false,queuable:true});this.publish("msgRowDblclick",{defaultFn:this._defMsgRowDblclickFn,emitFacade:false,queuable:true});this.publish("msgTbodyDblclick",{defaultFn:this._defMsgTbodyDblclickFn,emitFacade:false,queuable:true});P.delegate(H,this._onDomEvent,N,this,"theadCellFocus");P.delegate(K,this._onDomEvent,N,this,"theadCellKeydown");P.delegate(h,this._onDomEvent,N,this,"theadCellMouseenter");P.delegate(o,this._onDomEvent,N,this,"theadCellMouseleave");P.delegate(k,this._onDomEvent,N,this,"theadCellMouseup");P.delegate(z,this._onDomEvent,N,this,"theadCellMousedown");P.delegate(C,this._onDomEvent,N,this,"theadCellClick");M.delegate(v,this._onDomEvent,N,this,"theadCellDblclick");P.delegate(H,this._onDomEvent,O,this,"tbodyCellFocus");P.delegate(K,this._onDomEvent,O,this,"tbodyCellKeydown");P.delegate(h,this._onDomEvent,O,this,"tbodyCellMouseenter");P.delegate(o,this._onDomEvent,O,this,"tbodyCellMouseleave");P.delegate(k,this._onDomEvent,O,this,"tbodyCellMouseup");P.delegate(z,this._onDomEvent,O,this,"tbodyCellMousedown");P.delegate(C,this._onDomEvent,O,this,"tbodyCellClick");M.delegate(v,this._onDomEvent,O,this,"tbodyCellDblclick");P.delegate(H,this._onDomEvent,L,this,"msgCellFocus");P.delegate(K,this._onDomEvent,L,this,"msgCellKeydown");P.delegate(h,this._onDomEvent,L,this,"msgCellMouseenter");P.delegate(o,this._onDomEvent,L,this,"msgCellMouseleave");P.delegate(k,this._onDomEvent,L,this,"msgCellMouseup");P.delegate(z,this._onDomEvent,L,this,"msgCellMousedown");P.delegate(C,this._onDomEvent,L,this,"msgCellClick");M.delegate(v,this._onDomEvent,L,this,"msgCellDblclick");},_onDomEvent:function(M,L){this.fire(L,M);},_defTheadCellClickFn:function(L){this.fire("theadRowClick",L);},_defTheadRowClickFn:function(L){this.fire("theadClick",L);},_defTheadClickFn:function(L){},syncUI:function(){this._uiSetColumnset(this.get("columnset"));this._uiSetRecordset(this.get("recordset"));this._uiSetSummary(this.get("summary"));this._uiSetCaption(this.get("caption"));},_uiSetSummary:function(L){L=g(L)?L:"";this._tableNode.set("summary",L);},_uiSetCaption:function(L){L=g(L)?L:"";this._captionNode.setContent(L);},_uiSetColumnset:function(P){var M=P.tree,R=this._theadNode,N=0,L=M.length,O=R.get("parentNode"),Q=R.next();R.remove();R.get("children").remove(true);for(;N<L;++N){this._addTheadTrNode({thead:R,columns:M[N]},(N===0),(N===L-1));}O.insert(R,Q);},_addTheadTrNode:function(N,L,M){N.tr=this._createTheadTrNode(N,L,M);this._attachTheadTrNode(N);},_createTheadTrNode:function(S,M,R){var Q=t(F(this.get("trTemplate"),S)),O=0,N=S.columns,L=N.length,P;if(M){Q.addClass(E);}if(R){Q.addClass(i);}for(;O<L;++O){P=N[O];this._addTheadThNode({value:P.get("label"),column:P,tr:Q});}return Q;},_attachTheadTrNode:function(L){L.thead.appendChild(L.tr);},_addTheadThNode:function(L){L.th=this._createTheadThNode(L);this._attachTheadThNode(L);L.column.thNode=L.th;},_createTheadThNode:function(M){var L=M.column;M.id=L.get("id");M.colspan=L.colSpan;M.rowspan=L.rowSpan;M.classnames=L.get("classnames");M.value=F(this.get("thValueTemplate"),M);return t(F(this.thTemplate,M));},_attachTheadThNode:function(L){L.tr.appendChild(L.th);},_uiSetRecordset:function(M){var O=0,L=M.getLength(),N=this._tbodyNode,P=N.get("parentNode"),Q=N.next(),R={tbody:N};N.remove();for(;O<L;++O){R.record=M.getRecord(O);R.rowindex=O;this._addTbodyTrNode(R);}P.insert(N,Q);},_addTbodyTrNode:function(N){var M=N.tbody,L=N.record;N.tr=M.one("#"+L.get("id"))||this._createTbodyTrNode(N);this._attachTbodyTrNode(N);},_createTbodyTrNode:function(P){var O=t(F(this.get("trTemplate"),{id:P.record.get("id")})),M=0,N=this.get("columnset").keys,L=N.length;P.tr=O;for(;M<L;++M){P.column=N[M];this._addTbodyTdNode(P);}return O;},_attachTbodyTrNode:function(P){var M=P.tbody,O=P.tr,L=P.rowindex,N=M.get("children").item(L)||null,Q=(L%2===0);if(Q){O.replaceClass(A,u);}else{O.replaceClass(u,A);}M.insertBefore(O,N);},_addTbodyTdNode:function(L){L.td=this._createTbodyTdNode(L);this._attachTbodyTdNode(L);},_createTbodyTdNode:function(M){var L=M.column;M.headers=L.get("headers");M.classnames=L.get("classnames");M.value=this.formatDataCell(M);return t(F(this.tdTemplate,M));},_attachTbodyTdNode:function(L){L.tr.appendChild(L.td);},formatDataCell:function(M){var L=M.record;M.data=L.get("data");M.value=L.getValue(M.column.get("field"));return F(this.get("tdValueTemplate"),M);}});c.namespace("DataTable").Base=s;},"@VERSION@",{requires:["substitute","widget","recordset-base"]});
