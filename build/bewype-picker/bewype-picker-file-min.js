YUI.add("bewype-picker-file",function(c){var a="",b=function(d){b.superclass.constructor.apply(this,arguments);};a+='<div class="{pickerClass}"><table>';a+="  <tr>";a+="    <td>";a+='      <div class="{pickerClass}-label">File</div>';a+="    </td>";a+="    <td>";a+='      <form enctype="multipart/form-data" >';a+="        <div>";a+='          <input class="{pickerClass}-input" type="file" name="file" />';a+="        <div>";a+="        <div>";a+="      </form>";a+="    </td>";a+="  </tr>";a+="</table></div>";b.NAME="pickerFile";b.ATTRS={pickerClass:{value:"bewype-picker-file",writeOnce:true,validator:function(d){return c.Lang.isString(d);}},uploadUrl:{value:c.config.doc.location.href+"upload",writeOnce:true,validator:function(d){return c.Lang.isString(d);}}};c.extend(b,c.Widget,{_fileName:null,_q:null,initializer:function(d){this.publish("picker:onChange");},renderUI:function(){var f=this.get("contentBox"),e=this.get("pickerClass"),d=null;d=new c.Node.create(c.substitute(a,{pickerClass:e}));f.append(d);},bindUI:function(){},syncUI:function(){var f=this.get("contentBox"),d=this.get("pickerClass"),e=null;this._fileName=null;e=f.one("."+d+"-input");e.on("yui3-picker-event|change",c.bind(this._onInputChange,this));this._q=new c.AsyncQueue();},destructor:function(){var e=this.get("contentBox"),d=e.one("."+this.get("pickerClass"));if(d){c.detach("yui3-picker-event|change");d.remove();}},getValue:function(){return this._fileName;},setValue:function(d){this._fileName=d;},_hideMessage:function(d){d.remove();},_showMessage:function(h,e){var g=this.get("contentBox"),d=g.one("form"),f=null,k=this.get("pickerClass")+"-message",j=e?"error":"info",i=g.one("."+k);if(!d){return;}if(i){i.remove();}f='<a class="';f+=k;f+=" ";f+=k+j;f+='">';f+=h;f+="</a>";i=new c.Node.create(f);d.append(i);this._q.stop();this._q.add({fn:function(){},timeout:1000},{fn:this._hideMessage,args:[i]});this._q.run();},_doUpload:function(){var j=this.get("contentBox"),d=j.one("form"),i=this.get("uploadUrl"),g=null,f=null,e=null,h=null;g=function(l,k){this._showMessage("Upload started...");};f=function(n,l,m,k){if(l.responseText==="error"){this._showMessage("Upload failed!",true);}else{this._fileName=l.responseText;this._showMessage("File successfully uploaded");this.fire("picker:onChange");}};c.on("io:start",c.bind(g,this));c.on("io:complete",c.bind(f,this));e={method:"POST",form:{id:d,upload:true},headers:{"Content-Type":"multipart/form-data"}};h=c.io(i,e);},_onInputChange:function(d){var e=d?d.target:null;if(e){this._doUpload();}}});c.augment(b,c.EventTarget);c.namespace("Bewype");c.Bewype.PickerFile=b;},"@VERSION@",{requires:["async-queue","io","stylesheet","substitute","widget","yui-base"]});