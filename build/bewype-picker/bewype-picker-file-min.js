YUI.add("bewype-picker-file",function(C){var A="",B=function(D){B.superclass.constructor.apply(this,arguments);};A+='<div class="{pickerClass}"><table>';A+="  <tr>";A+="    <td>";A+='      <div class="{pickerClass}-label">File</div>';A+="    </td>";A+="    <td>";A+='      <form enctype="multipart/form-data" >';A+="        <div>";A+='          <input class="{pickerClass}-input" type="file" name="file" />';A+="        <div>";A+="        <div>";A+="      </form>";A+="    </td>";A+="  </tr>";A+="</table></div>";B.NAME="pickerFile";B.ATTRS={pickerClass:{value:"bewype-picker-file",writeOnce:true,validator:function(D){return C.Lang.isString(D);}},uploadUrl:{value:C.config.doc.location.href+"upload",writeOnce:true,validator:function(D){return C.Lang.isString(D);}}};C.extend(B,C.Widget,{_fileName:null,_q:null,initializer:function(D){this.publish("picker:onChange");},renderUI:function(){var F=this.get("contentBox"),E=this.get("pickerClass"),D=null;D=new C.Node.create(C.substitute(A,{pickerClass:E}));F.append(D);},bindUI:function(){},syncUI:function(){var F=this.get("contentBox"),D=this.get("pickerClass"),E=null;this._fileName=null;E=F.one("."+D+"-input");E.on("yui3-picker-event|change",C.bind(this._onInputChange,this));this._q=new C.AsyncQueue();},destructor:function(){var E=this.get("contentBox"),D=E.one("."+this.get("pickerClass"));if(D){C.detach("yui3-picker-event|change");D.remove();}},getValue:function(){return this._fileName;},setValue:function(D){this._fileName=D;},_hideMessage:function(D){D.remove();},_showMessage:function(H,E){var G=this.get("contentBox"),D=G.one("form"),F=null,K=this.get("pickerClass")+"-message",J=E?"error":"info",I=G.one("."+K);if(!D){return;}if(I){I.remove();}F='<a class="';F+=K;F+=" ";F+=K+J;F+='">';F+=H;F+="</a>";I=new C.Node.create(F);D.append(I);this._q.stop();this._q.add({fn:function(){},timeout:1000},{fn:this._hideMessage,args:[I]});this._q.run();},_doUpload:function(){var J=this.get("contentBox"),D=J.one("form"),I=this.get("uploadUrl"),G=null,F=null,E=null,H=null;G=function(L,K){this._showMessage("Upload started...");};F=function(N,L,M,K){if(L.responseText==="error"){this._showMessage("Upload failed!",true);}else{this._fileName=L.responseText;this._showMessage("File successfully uploaded");this.fire("picker:onChange");}};C.on("io:start",C.bind(G,this));C.on("io:complete",C.bind(F,this));E={method:"POST",form:{id:D,upload:true},headers:{"Content-Type":"multipart/form-data"}};H=C.io(I,E);},_onInputChange:function(D){var E=D?D.target:null;if(E){this._doUpload();}}});C.augment(B,C.EventTarget);C.namespace("Bewype");C.Bewype.PickerFile=B;},"@VERSION@",{requires:["async-queue","io","stylesheet","substitute","widget","yui-base"]});