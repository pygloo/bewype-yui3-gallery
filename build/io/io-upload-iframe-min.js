YUI.add("io-upload-iframe",function(C){var M=C.config.win,I=C.config.doc,G=(I.documentMode&&I.documentMode>=8),H=decodeURIComponent;function E(T,S){var U=[],P=S.split("="),R,Q;for(R=0,Q=P.length-1;R<Q;R++){U[R]=I.createElement("input");U[R].type="hidden";U[R].name=H(P[R].substring(P[R].lastIndexOf("&")+1));U[R].value=(R+1===Q)?H(P[R+1]):H(P[R+1].substring(0,(P[R+1].lastIndexOf("&"))));T.appendChild(U[R]);}return U;}function J(R,S){var Q,P;for(Q=0,P=S.length;Q<P;Q++){R.removeChild(S[Q]);}}function F(Q,R,P){Q.setAttribute("action",P);Q.setAttribute("method","POST");Q.setAttribute("target","ioupload"+R);Q.setAttribute(C.UA.ie&&!G?"encoding":"enctype","multipart/form-data");}function O(Q,P){var R;for(R in P){if(P.hasOwnProperty(R)){if(P[R]){Q.setAttribute(R,Q[R]);}else{Q.removeAttribute(R);}}}}function D(P,Q){C.io._timeout[P.id]=M.setTimeout(function(){var R={id:P.id,status:"timeout"};C.io.complete(R,Q);C.io.end(R,Q);},Q.timeout);}function L(P){M.clearTimeout(C.io._timeout[P]);delete C.io._timeout[P];}function K(P){C.Event.purgeElement("#ioupload"+P,false);C.one("body").removeChild(C.one("#ioupload"+P));}function A(S,T){var R=C.one("#ioupload"+S.id).get("contentWindow.document"),P=R.one("body"),Q;if(T.timeout){L(S.id);}if(P&&(C.UA.ie!==0||C.UA.webkit>1)){S.c.responseText=P.get("outerText");}else{if(P){Q=P.query("pre:first-child");S.c.responseText=Q?Q.get("text"):P.get("text");}else{S.c.responseXML=R._node;}}C.io.complete(S,T);C.io.end(S,T);M.setTimeout(function(){K(S.id);},0);}function N(Q,R){var P=C.Node.create('<iframe id="ioupload'+Q.id+'" name="ioupload'+Q.id+'" />');P._node.style.position="absolute";P._node.style.top="-1000px";P._node.style.left="-1000px";C.one("body").appendChild(P);C.on("load",function(){A(Q,R);},"#ioupload"+Q.id);}function B(T,R,U){var S=(typeof U.form.id==="string")?I.getElementById(U.form.id):U.form.id,Q,P={action:S.getAttribute("action"),target:S.getAttribute("target")};F(S,T.id,R);if(U.data){Q=E(S,U.data);}if(U.timeout){D(T,U);}S.submit();C.io.start(T.id,U);if(U.data){J(S,Q);}O(S,P);return{id:T.id,abort:function(){var V={id:T.id,status:"abort"};if(C.one("#ioupload"+T.id)){K(T.id);C.io.complete(V,U);C.io.end(V,U);}else{return false;}},isInProgress:function(){return C.one("#ioupload"+T.id)?true:false;}};}C.mix(C.io,{upload:function(Q,P,R){N(Q,R);return B(Q,P,R);}});},"@VERSION@",{requires:["io-base","node-base"]});