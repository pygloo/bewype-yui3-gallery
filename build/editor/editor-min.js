YUI.add("frame",function(D){var A=function(){A.superclass.constructor.apply(this,arguments);},C=":last-child",B="body";D.extend(A,D.Base,{_ready:null,_rendered:null,_iframe:null,_instance:null,_create:function(E){var K,J,G,I;this._iframe=D.Node.create(A.HTML);this._iframe.setStyle("visibility","hidden");this._iframe.set("src",this.get("src"));this.get("container").append(this._iframe);this._iframe.set("height","99%");var F="",H=((this.get("extracss"))?'<style id="extra_css">'+this.get("extracss")+"</style>":"");F=D.substitute(A.PAGE_HTML,{DIR:this.get("dir"),LANG:this.get("lang"),TITLE:this.get("title"),META:A.META,LINKED_CSS:this.get("linkedcss"),CONTENT:this.get("content"),BASE_HREF:this.get("basehref"),DEFAULT_CSS:A.DEFAULT_CSS,EXTRA_CSS:H});if(D.config.doc.compatMode!="BackCompat"){F=A.getDocType()+"\n"+F;}else{}G=this._resolveWinDoc();G.doc.open();G.doc.write(F);G.doc.close();if(!G.doc.documentElement){var L=D.later(1,this,function(){if(G.doc&&G.doc.documentElement){E(G);L.cancel();}},null,true);}else{E(G);}},_resolveWinDoc:function(F){var E=(F)?F:{};E.win=D.Node.getDOMNode(this._iframe.get("contentWindow"));E.doc=D.Node.getDOMNode(this._iframe.get("contentWindow.document"));if(!E.doc){E.doc=D.config.doc;}if(!E.win){E.win=D.config.win;}return E;},_onDomEvent:function(G){var F,E;G.frameX=G.frameY=0;if(G.pageX>0||G.pageY>0){if(G.type.substring(0,3)!=="key"){E=this._instance.one("win");F=this._iframe.getXY();G.frameX=F[0]+G.pageX-E.get("scrollLeft");G.frameY=F[1]+G.pageY-E.get("scrollTop");}}G.frameTarget=G.target;G.frameCurrentTarget=G.currentTarget;G.frameEvent=G;this.fire("dom:"+G.type,G);},initializer:function(){this.publish("ready",{emitFacade:true,defaultFn:this._defReadyFn});},destructor:function(){var E=this.getInstance();E.one("doc").detachAll();E=null;this._iframe.remove();},_DOMPaste:function(H){var F=this.getInstance(),E="",G=F.config.win;if(H._event.originalTarget){E=H._event.originalTarget;}if(H._event.clipboardData){E=H._event.clipboardData.getData("Text");}if(G.clipboardData){E=G.clipboardData.getData("Text");if(E===""){if(!G.clipboardData.setData("Text",E)){E=null;}}}H.frameTarget=H.target;H.frameCurrentTarget=H.currentTarget;H.frameEvent=H;if(E){H.clipboardData={data:E,getData:function(){return E;}};}else{H.clipboardData=null;}this.fire("dom:paste",H);},_defReadyFn:function(){var E=this.getInstance();D.each(A.DOM_EVENTS,function(G,F){var H=D.bind(this._onDomEvent,this),I=((D.UA.ie)?D.throttle(H,200):H);if(!E.Node.DOM_EVENTS[F]){E.Node.DOM_EVENTS[F]=1;}if(G===1){if(F!=="focus"&&F!=="blur"&&F!=="paste"){if(F.substring(0,3)==="key"){E.on(F,I,E.config.doc);}else{E.on(F,H,E.config.doc);}}}},this);E.Node.DOM_EVENTS.paste=1;E.on("paste",D.bind(this._DOMPaste,this),E.one("body"));E.on("focus",D.bind(this._onDomEvent,this),E.config.win);E.on("blur",D.bind(this._onDomEvent,this),E.config.win);E._use=E.use;E.use=D.bind(this.use,this);this._iframe.setStyles({visibility:"inherit"});E.one("body").setStyle("display","block");if(D.UA.ie){this._fixIECursors();}},_fixIECursors:function(){var H=this.getInstance(),F=H.all("table"),G=H.all("br"),E;if(F.size()&&G.size()){E=F.item(0).get("sourceIndex");G.each(function(L){var J=L.get("parentNode"),K=J.get("children"),I=J.all(">br");if(J.test("div")){if(K.size()>2){L.replace(H.Node.create("<wbr>"));}else{if(L.get("sourceIndex")>E){if(I.size()){L.replace(H.Node.create("<wbr>"));}}else{if(I.size()>1){L.replace(H.Node.create("<wbr>"));}}}}});}},_onContentReady:function(G){if(!this._ready){this._ready=true;var F=this.getInstance(),E=D.clone(this.get("use"));this.fire("contentready");if(G){F.config.doc=D.Node.getDOMNode(G.target);}E.push(D.bind(function(){if(F.Selection){F.Selection.DEFAULT_BLOCK_TAG=this.get("defaultblock");}if(this.get("designMode")){if(D.UA.ie){F.config.doc.body.contentEditable="true";this._ieSetBodyHeight();F.on("keyup",D.bind(this._ieSetBodyHeight,this),F.config.doc);}else{F.config.doc.designMode="on";}}this.fire("ready");},this));F.use.apply(F,E);F.one("doc").get("documentElement").addClass("yui-js-enabled");}},_ieHeightCounter:null,_ieSetBodyHeight:function(I){if(!this._ieHeightCounter){this._ieHeightCounter=0;}this._ieHeightCounter++;var H=false;if(!I){H=true;}if(I){switch(I.keyCode){case 8:case 13:H=true;break;}if(I.ctrlKey||I.shiftKey){H=true;}}if(H){try{var G=this.getInstance();var F=this._iframe.get("offsetHeight");var E=G.config.doc.body.scrollHeight;if(F>E){F=(F-15)+"px";G.config.doc.body.style.height=F;}else{G.config.doc.body.style.height="auto";}}catch(I){if(this._ieHeightCounter<100){D.later(200,this,this._ieSetBodyHeight);}else{}}}},_resolveBaseHref:function(E){if(!E||E===""){E=D.config.doc.location.href;if(E.indexOf("?")!==-1){E=E.substring(0,E.indexOf("?"));}E=E.substring(0,E.lastIndexOf("/"))+"/";}return E;},_getHTML:function(E){if(this._ready){var F=this.getInstance();E=F.one("body").get("innerHTML");}return E;},_setHTML:function(E){if(this._ready){var F=this.getInstance();F.one("body").set("innerHTML",E);}else{this.on("contentready",D.bind(function(G,I){var H=this.getInstance();H.one("body").set("innerHTML",G);},this,E));}return E;},_getLinkedCSS:function(E){if(!D.Lang.isArray(E)){E=[E];}var F="";if(!this._ready){D.each(E,function(G){if(G!==""){F+='<link rel="stylesheet" href="'+G+'" type="text/css">';}});}else{F=E;}return F;},_setLinkedCSS:function(E){if(this._ready){var F=this.getInstance();F.Get.css(E);}return E;},_setExtraCSS:function(E){if(this._ready){var G=this.getInstance(),F=G.one("#extra_css");F.remove();G.one("head").append('<style id="extra_css">'+E+"</style>");}return E;},_instanceLoaded:function(F){this._instance=F;this._onContentReady();var G=this._instance.config.doc;if(this.get("designMode")){if(!D.UA.ie){try{G.execCommand("styleWithCSS",false,false);G.execCommand("insertbronreturn",false,false);}catch(E){}}}},use:function(){var G=this.getInstance(),F=D.Array(arguments),E=false;if(D.Lang.isFunction(F[F.length-1])){E=F.pop();}if(E){F.push(function(){E.apply(G,arguments);});}G._use.apply(G,F);},delegate:function(G,F,E,I){var H=this.getInstance();
if(!H){return false;}if(!I){I=E;E="body";}return H.delegate(G,F,E,I);},getInstance:function(){return this._instance;},render:function(E){if(this._rendered){return this;}this._rendered=true;if(E){this.set("container",E);}this._create(D.bind(function(I){var K,L,F=D.bind(function(M){this._instanceLoaded(M);},this),H=D.clone(this.get("use")),G={debug:false,win:I.win,doc:I.doc},J=D.bind(function(){G=this._resolveWinDoc(G);K=YUI(G);try{K.use("node-base",F);if(L){clearInterval(L);}}catch(M){L=setInterval(function(){J();},350);}},this);H.push(J);D.use.apply(D,H);},this));return this;},_handleFocus:function(){var H=this.getInstance(),G=new H.Selection();if(G.anchorNode){var J=G.anchorNode,I;if(J.test("p")&&J.get("innerHTML")===""){J=J.get("parentNode");}I=J.get("childNodes");if(I.size()){if(I.item(0).test("br")){G.selectNode(J,true,false);}else{if(I.item(0).test("p")){J=I.item(0).one("br.yui-cursor");if(J){J=J.get("parentNode");}if(!J){J=I.item(0).get("firstChild");}if(!J){J=I.item(0);}if(J){G.selectNode(J,true,false);}}else{var E=H.one("br.yui-cursor");if(E){var F=E.get("parentNode");if(F){G.selectNode(F,true,false);}}}}}}},focus:function(E){if(D.UA.ie){try{D.one("win").focus();this.getInstance().one("win").focus();}catch(G){}if(E===true){this._handleFocus();}if(D.Lang.isFunction(E)){E();}}else{try{D.one("win").focus();D.later(100,this,function(){this.getInstance().one("win").focus();if(E===true){this._handleFocus();}if(D.Lang.isFunction(E)){E();}});}catch(F){}}return this;},show:function(){this._iframe.setStyles({position:"static",left:""});if(D.UA.gecko){try{this._instance.config.doc.designMode="on";}catch(E){}this.focus();}return this;},hide:function(){this._iframe.setStyles({position:"absolute",left:"-999999px"});return this;}},{DOM_EVENTS:{dblclick:1,click:1,paste:1,mouseup:1,mousedown:1,keyup:1,keydown:1,keypress:1,activate:1,deactivate:1,beforedeactivate:1,focusin:1,focusout:1},DEFAULT_CSS:"body { background-color: #fff; font: 13px/1.22 arial,helvetica,clean,sans-serif;*font-size:small;*font:x-small; } a, a:visited, a:hover { color: blue !important; text-decoration: underline !important; cursor: text !important; } img { cursor: pointer !important; border: none; }",HTML:'<iframe border="0" frameBorder="0" marginWidth="0" marginHeight="0" leftMargin="0" topMargin="0" allowTransparency="true" width="100%" height="99%"></iframe>',PAGE_HTML:'<html dir="{DIR}" lang="{LANG}"><head><title>{TITLE}</title>{META}<base href="{BASE_HREF}"/>{LINKED_CSS}<style id="editor_css">{DEFAULT_CSS}</style>{EXTRA_CSS}</head><body>{CONTENT}</body></html>',getDocType:function(){var E=D.config.doc.doctype,F=A.DOC_TYPE;if(E){F="<!DOCTYPE "+E.name+((E.publicId)?" "+E.publicId:"")+((E.systemId)?" "+E.systemId:"")+">";}else{if(D.config.doc.all){E=D.config.doc.all[0];if(E.nodeType){if(E.nodeType===8){if(E.nodeValue){if(E.nodeValue.toLowerCase().indexOf("doctype")!==-1){F="<!"+E.nodeValue+">";}}}}}}return F;},DOC_TYPE:'<!DOCTYPE HTML PUBLIC "-/'+"/W3C/"+"/DTD HTML 4.01/"+'/EN" "http:/'+'/www.w3.org/TR/html4/strict.dtd">',META:'<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/><meta http-equiv="X-UA-Compatible" content="IE=7">',NAME:"frame",ATTRS:{title:{value:"Blank Page"},dir:{value:"ltr"},lang:{value:"en-US"},src:{value:"javascript"+((D.UA.ie)?":false":":")+";"},designMode:{writeOnce:true,value:false},content:{value:"<br>",setter:"_setHTML",getter:"_getHTML"},basehref:{value:false,getter:"_resolveBaseHref"},use:{writeOnce:true,value:["substitute","node","node-style","selector-css3"]},container:{value:"body",setter:function(E){return D.one(E);}},node:{readOnly:true,value:null,getter:function(){return this._iframe;}},id:{writeOnce:true,getter:function(E){if(!E){E="iframe-"+D.guid();}return E;}},linkedcss:{value:"",getter:"_getLinkedCSS",setter:"_setLinkedCSS"},extracss:{value:"",setter:"_setExtraCSS"},host:{value:false},defaultblock:{value:"p"}}});D.Frame=A;},"@VERSION@",{skinnable:false,requires:["base","node","selector-css3","substitute"]});YUI.add("selection",function(B){var A="textContent",D="innerHTML",C="fontFamily";if(B.UA.ie){A="nodeValue";}B.Selection=function(M){var I,N,F,G,E,K;if(B.config.win.getSelection){I=B.config.win.getSelection();}else{if(B.config.doc.selection){I=B.config.doc.selection.createRange();}}this._selection=I;if(I.pasteHTML){this.isCollapsed=(I.compareEndPoints("StartToEnd",I))?false:true;if(this.isCollapsed){this.anchorNode=this.focusNode=B.one(I.parentElement());if(M){F=B.config.doc.elementFromPoint(M.clientX,M.clientY);}E=I.duplicate();if(!F){N=I.parentElement();G=N.childNodes;for(K=0;K<G.length;K++){if(E.inRange(I)){if(!F){F=G[K];}}}}this.ieNode=F;if(F){if(F.nodeType!==3){if(F.firstChild){F=F.firstChild;}if(F&&F.tagName&&F.tagName.toLowerCase()==="body"){if(F.firstChild){F=F.firstChild;}}}this.anchorNode=this.focusNode=B.Selection.resolve(F);E.moveToElementText(I.parentElement());var L=I.compareEndPoints("StartToStart",E),O=0;if(L){O=Math.abs(I.move("character",-9999));}this.anchorOffset=this.focusOffset=O;this.anchorTextNode=this.focusTextNode=B.one(F);}}else{if(I.htmlText&&I.htmlText!==""){var J=B.Node.create(I.htmlText);if(J&&J.get("id")){var H=J.get("id");this.anchorNode=this.focusNode=B.one("#"+H);}else{if(J){J=J.get("childNodes");this.anchorNode=this.focusNode=J.item(0);}}}}}else{this.isCollapsed=I.isCollapsed;this.anchorNode=B.Selection.resolve(I.anchorNode);this.focusNode=B.Selection.resolve(I.focusNode);this.anchorOffset=I.anchorOffset;this.focusOffset=I.focusOffset;this.anchorTextNode=B.one(I.anchorNode);this.focusTextNode=B.one(I.focusNode);}if(B.Lang.isString(I.text)){this.text=I.text;}else{if(I.toString){this.text=I.toString();}else{this.text="";}}};B.Selection.removeFontFamily=function(F){F.removeAttribute("face");var E=F.getAttribute("style").toLowerCase();if(E===""||(E=="font-family: ")){F.removeAttribute("style");}if(E.match(B.Selection.REG_FONTFAMILY)){E=E.replace(B.Selection.REG_FONTFAMILY,"");F.setAttribute("style",E);}};B.Selection.filter=function(E){var H=(new Date()).getTime();
var G=B.all(B.Selection.ALL),K=B.all("strong,em"),N=B.config.doc,P,F={},I="",L;var J=(new Date()).getTime();G.each(function(R){var Q=B.Node.getDOMNode(R);if(Q.style[C]){F["."+R._yuid]=Q.style[C];R.addClass(R._yuid);B.Selection.removeFontFamily(Q);}});var O=(new Date()).getTime();B.all(".hr").addClass("yui-skip").addClass("yui-non");if(B.UA.ie){P=N.getElementsByTagName("hr");B.each(P,function(S){var R=N.createElement("div");R.className="hr yui-non yui-skip";R.setAttribute("readonly",true);R.setAttribute("contenteditable",false);if(S.parentNode){S.parentNode.replaceChild(R,S);}var Q=R.style;Q.border="1px solid #ccc";Q.lineHeight="0";Q.fontSize="0";Q.marginTop="5px";Q.marginBottom="5px";Q.marginLeft="0px";Q.marginRight="0px";Q.padding="0";});}B.each(F,function(R,Q){I+=Q+" { font-family: "+R.replace(/"/gi,"")+"; }";});B.StyleSheet(I,"editor");K.each(function(T,Q){var R=T.get("tagName").toLowerCase(),S="i";if(R==="strong"){S="b";}B.Selection.prototype._swap(K.item(Q),S);});L=B.all("ol,ul");L.each(function(R,Q){var S=R.all("li");if(!S.size()){R.remove();}});if(E){B.Selection.filterBlocks();}var M=(new Date()).getTime();};B.Selection.filterBlocks=function(){var F=(new Date()).getTime();var M=B.config.doc.body.childNodes,H,G,P=false,J=true,E,Q,R,O,L,N,S;if(M){for(H=0;H<M.length;H++){G=B.one(M[H]);if(!G.test(B.Selection.BLOCKS)){J=true;if(M[H].nodeType==3){N=M[H][A].match(B.Selection.REG_CHAR);S=M[H][A].match(B.Selection.REG_NON);if(N===null&&S){J=false;}}if(J){if(!P){P=[];}P.push(M[H]);}}else{P=B.Selection._wrapBlock(P);}}P=B.Selection._wrapBlock(P);}Q=B.all(B.Selection.DEFAULT_BLOCK_TAG);if(Q.size()===1){R=Q.item(0).all("br");if(R.size()===1){if(!R.item(0).test(".yui-cursor")){R.item(0).remove();}var I=Q.item(0).get("innerHTML");if(I===""||I===" "){Q.set("innerHTML",B.Selection.CURSOR);E=new B.Selection();E.focusCursor(true,true);}if(R.item(0).test(".yui-cursor")&&B.UA.ie){R.item(0).remove();}}}else{Q.each(function(U){var T=U.get("innerHTML");if(T===""){U.remove();}});}if(!B.UA.ie){}var K=(new Date()).getTime();};B.Selection.REG_FONTFAMILY=/font-family: ;/;B.Selection.REG_CHAR=/[a-zA-Z-0-9_!@#\$%\^&*\(\)-=_+\[\]\\{}|;':",.\/<>\?]/gi;B.Selection.REG_NON=/[\s\S|\n|\t]/gi;B.Selection.REG_NOHTML=/<\S[^><]*>/g;B.Selection._wrapBlock=function(F){if(F){var E=B.Node.create("<"+B.Selection.DEFAULT_BLOCK_TAG+"></"+B.Selection.DEFAULT_BLOCK_TAG+">"),H=B.one(F[0]),G;for(G=1;G<F.length;G++){E.append(F[G]);}H.replace(E);E.prepend(H);}return false;};B.Selection.unfilter=function(){var G=B.all("body [class]"),H="",F,I,E=B.one("body");G.each(function(J){if(J.hasClass(J._yuid)){J.setStyle(C,J.getStyle(C));J.removeClass(J._yuid);if(J.getAttribute("class")===""){J.removeAttribute("class");}}});F=B.all(".yui-non");F.each(function(J){if(!J.hasClass("yui-skip")&&J.get("innerHTML")===""){J.remove();}else{J.removeClass("yui-non").removeClass("yui-skip");}});I=B.all("body [id]");I.each(function(J){if(J.get("id").indexOf("yui_3_")===0){J.removeAttribute("id");J.removeAttribute("_yuid");}});if(E){H=E.get("innerHTML");}B.all(".hr").addClass("yui-skip").addClass("yui-non");return H;};B.Selection.resolve=function(F){if(F&&F.nodeType===3){try{F=F.parentNode;}catch(E){F="body";}}return B.one(F);};B.Selection.getText=function(F){var E=F.get("innerHTML").replace(B.Selection.REG_NOHTML,"");E=E.replace("<span><br></span>","").replace("<br>","");return E;};B.Selection.DEFAULT_BLOCK_TAG="p";B.Selection.ALL="[style],font[face]";B.Selection.BLOCKS="p,div,ul,ol,table,style";B.Selection.TMP="yui-tmp";B.Selection.DEFAULT_TAG="span";B.Selection.CURID="yui-cursor";B.Selection.CUR_WRAPID="yui-cursor-wrapper";B.Selection.CURSOR='<span><br class="yui-cursor"></span>';B.Selection.hasCursor=function(){var E=B.all("#"+B.Selection.CUR_WRAPID);return E.size();};B.Selection.cleanCursor=function(){var F,E="br.yui-cursor";F=B.all(E);if(F.size()){F.each(function(G){var I=G.get("parentNode.parentNode.childNodes"),H;if(I.size()){G.remove();}else{H=B.Selection.getText(I.item(0));if(H!==""){G.remove();}}});}};B.Selection.prototype={text:null,isCollapsed:null,anchorNode:null,anchorOffset:null,anchorTextNode:null,focusNode:null,focusOffset:null,focusTextNode:null,_selection:null,_wrap:function(G,E){var F=B.Node.create("<"+E+"></"+E+">");F.set(D,G.get(D));G.set(D,"");G.append(F);return B.Node.getDOMNode(F);},_swap:function(G,E){var F=B.Node.create("<"+E+"></"+E+">");F.set(D,G.get(D));G.replace(F,G);return B.Node.getDOMNode(F);},getSelected:function(){B.Selection.filter();B.config.doc.execCommand("fontname",null,B.Selection.TMP);var F=B.all(B.Selection.ALL),E=[];F.each(function(H,G){if(H.getStyle(C)==B.Selection.TMP){H.setStyle(C,"");B.Selection.removeFontFamily(H);if(!H.test("body")){E.push(B.Node.getDOMNode(F.item(G)));}}});return B.all(E);},insertContent:function(E){return this.insertAtCursor(E,this.anchorTextNode,this.anchorOffset,true);},insertAtCursor:function(K,F,H,N){var P=B.Node.create("<"+B.Selection.DEFAULT_TAG+' class="yui-non"></'+B.Selection.DEFAULT_TAG+">"),E,I,G,O,J=this.createRange(),M;if(F&&F.test("body")){M=B.Node.create("<span></span>");F.append(M);F=M;}if(J.pasteHTML){if(H===0&&F&&!F.previous()&&F.get("nodeType")===3){F.insert(K,"before");if(J.moveToElementText){J.moveToElementText(B.Node.getDOMNode(F.previous()));}J.collapse(false);J.select();return F.previous();}else{O=B.Node.create(K);try{J.pasteHTML('<span id="rte-insert"></span>');}catch(L){}E=B.one("#rte-insert");if(E){E.set("id","");E.replace(O);if(J.moveToElementText){J.moveToElementText(B.Node.getDOMNode(O));}J.collapse(false);J.select();return O;}else{B.on("available",function(){E.set("id","");E.replace(O);if(J.moveToElementText){J.moveToElementText(B.Node.getDOMNode(O));}J.collapse(false);J.select();},"#rte-insert");}}}else{if(H>0){E=F.get(A);I=B.one(B.config.doc.createTextNode(E.substr(0,H)));G=B.one(B.config.doc.createTextNode(E.substr(H)));F.replace(I,F);O=B.Node.create(K);if(O.get("nodeType")===11){M=B.Node.create("<span></span>");M.append(O);O=M;}I.insert(O,"after");if(G){O.insert(P,"after");
P.insert(G,"after");this.selectNode(P,N);}}else{if(F.get("nodeType")===3){F=F.get("parentNode");}O=B.Node.create(K);K=F.get("innerHTML").replace(/\n/gi,"");if(K===""||K==="<br>"){F.append(O);}else{if(O.get("parentNode")){F.insert(O,"before");}else{B.one("body").prepend(O);}}if(F.get("firstChild").test("br")){F.get("firstChild").remove();}}}return O;},wrapContent:function(F){F=(F)?F:B.Selection.DEFAULT_TAG;if(!this.isCollapsed){var H=this.getSelected(),K=[],G,I,J,E;H.each(function(N,L){var M=N.get("tagName").toLowerCase();if(M==="font"){K.push(this._swap(H.item(L),F));}else{K.push(this._wrap(H.item(L),F));}},this);G=this.createRange();J=K[0];I=K[K.length-1];if(this._selection.removeAllRanges){G.setStart(K[0],0);G.setEnd(I,I.childNodes.length);this._selection.removeAllRanges();this._selection.addRange(G);}else{if(G.moveToElementText){G.moveToElementText(B.Node.getDOMNode(J));E=this.createRange();E.moveToElementText(B.Node.getDOMNode(I));G.setEndPoint("EndToEnd",E);}G.select();}K=B.all(K);return K;}else{return B.all([]);}},replace:function(K,I){var F=this.createRange(),J,E,G,H;if(F.getBookmark){G=F.getBookmark();E=this.anchorNode.get("innerHTML").replace(K,I);this.anchorNode.set("innerHTML",E);F.moveToBookmark(G);H=B.one(F.parentElement());}else{J=this.anchorTextNode;E=J.get(A);G=E.indexOf(K);E=E.replace(K,"");J.set(A,E);H=this.insertAtCursor(I,J,G,true);}return H;},remove:function(){this._selection.removeAllRanges();return this;},createRange:function(){if(B.config.doc.selection){return B.config.doc.selection.createRange();}else{return B.config.doc.createRange();}},selectNode:function(H,J,E){if(!H){return;}E=E||0;H=B.Node.getDOMNode(H);var F=this.createRange();if(F.selectNode){F.selectNode(H);this._selection.removeAllRanges();this._selection.addRange(F);if(J){try{this._selection.collapse(H,E);}catch(G){this._selection.collapse(H,0);}}}else{if(H.nodeType===3){H=H.parentNode;}try{F.moveToElementText(H);}catch(I){}if(J){F.collapse(((E)?false:true));}F.select();}return this;},setCursor:function(){this.removeCursor(false);return this.insertContent(B.Selection.CURSOR);},getCursor:function(){return B.all("#"+B.Selection.CURID);},removeCursor:function(E){var F=this.getCursor();if(F){if(E){F.removeAttribute("id");F.set("innerHTML",'<br class="yui-cursor">');}else{F.remove();}}return F;},focusCursor:function(G,E){if(G!==false){G=true;}if(E!==false){E=true;}var F=this.removeCursor(true);if(F){F.each(function(H){this.selectNode(H,G,E);},this);}},toString:function(){return"Selection Object";}};},"@VERSION@",{skinnable:false,requires:["node"]});YUI.add("exec-command",function(B){var A=function(){A.superclass.constructor.apply(this,arguments);};B.extend(A,B.Base,{_lastKey:null,_inst:null,command:function(F,E){var D=A.COMMANDS[F];if(D){return D.call(this,F,E);}else{return this._command(F,E);}},_command:function(F,E){var D=this.getInstance();try{try{D.config.doc.execCommand("styleWithCSS",null,1);}catch(I){try{D.config.doc.execCommand("useCSS",null,0);}catch(H){}}D.config.doc.execCommand(F,null,E);}catch(G){}},getInstance:function(){if(!this._inst){this._inst=this.get("host").getInstance();}return this._inst;},initializer:function(){B.mix(this.get("host"),{execCommand:function(E,D){return this.exec.command(E,D);},_execCommand:function(E,D){return this.exec._command(E,D);}});this.get("host").on("dom:keypress",B.bind(function(D){this._lastKey=D.keyCode;},this));}},{NAME:"execCommand",NS:"exec",ATTRS:{host:{value:false}},COMMANDS:{wrap:function(F,D){var E=this.getInstance();return(new E.Selection()).wrapContent(D);},inserthtml:function(F,D){var E=this.getInstance();if(E.Selection.hasCursor()||B.UA.ie){return(new E.Selection()).insertContent(D);}else{this._command("inserthtml",D);}},insertandfocus:function(H,E){var G=this.getInstance(),D,F;if(G.Selection.hasCursor()){E+=G.Selection.CURSOR;D=this.command("inserthtml",E);F=new G.Selection();F.focusCursor(true,true);}else{this.command("inserthtml",E);}return D;},insertbr:function(J){var I=this.getInstance(),H=new I.Selection(),D="<var>|</var>",E=null,G=(B.UA.webkit)?"span.Apple-style-span,var":"var";if(H._selection.pasteHTML){H._selection.pasteHTML(D);}else{this._command("inserthtml",D);}var F=function(L){var K=I.Node.create("<br>");L.insert(K,"before");return K;};I.all(G).each(function(M){var L=true;if(B.UA.webkit){L=false;if(M.get("innerHTML")==="|"){L=true;}}if(L){E=F(M);if((!E.previous()||!E.previous().test("br"))&&B.UA.gecko){var K=E.cloneNode();E.insert(K,"after");E=K;}M.remove();}});if(B.UA.webkit&&E){F(E);H.selectNode(E);}},insertimage:function(E,D){return this.command("inserthtml",'<img src="'+D+'">');},addclass:function(F,D){var E=this.getInstance();return(new E.Selection()).getSelected().addClass(D);},removeclass:function(F,D){var E=this.getInstance();return(new E.Selection()).getSelected().removeClass(D);},forecolor:function(F,G){var E=this.getInstance(),D=new E.Selection(),H;if(!B.UA.ie){this._command("useCSS",false);}if(E.Selection.hasCursor()){if(D.isCollapsed){if(D.anchorNode&&(D.anchorNode.get("innerHTML")==="&nbsp;")){D.anchorNode.setStyle("color",G);H=D.anchorNode;}else{H=this.command("inserthtml",'<span style="color: '+G+'">'+E.Selection.CURSOR+"</span>");D.focusCursor(true,true);}return H;}else{return this._command(F,G);}}else{this._command(F,G);}},backcolor:function(F,G){var E=this.getInstance(),D=new E.Selection(),H;if(B.UA.gecko||B.UA.opera){F="hilitecolor";}if(!B.UA.ie){this._command("useCSS",false);}if(E.Selection.hasCursor()){if(D.isCollapsed){if(D.anchorNode&&(D.anchorNode.get("innerHTML")==="&nbsp;")){D.anchorNode.setStyle("backgroundColor",G);H=D.anchorNode;}else{H=this.command("inserthtml",'<span style="background-color: '+G+'">'+E.Selection.CURSOR+"</span>");D.focusCursor(true,true);}return H;}else{return this._command(F,G);}}else{this._command(F,G);}},hilitecolor:function(){return A.COMMANDS.backcolor.apply(this,arguments);},fontname2:function(F,G){this._command("fontname",G);var E=this.getInstance(),D=new E.Selection();if(D.isCollapsed&&(this._lastKey!=32)){if(D.anchorNode.test("font")){D.anchorNode.set("face",G);
}}},fontsize2:function(F,H){this._command("fontsize",H);var E=this.getInstance(),D=new E.Selection();if(D.isCollapsed&&D.anchorNode&&(this._lastKey!=32)){if(B.UA.webkit){if(D.anchorNode.getStyle("lineHeight")){D.anchorNode.setStyle("lineHeight","");}}if(D.anchorNode.test("font")){D.anchorNode.set("size",H);}else{if(B.UA.gecko){var G=D.anchorNode.ancestor(E.Selection.DEFAULT_BLOCK_TAG);if(G){G.setStyle("fontSize","");}}}}},insertunorderedlist:function(D){this.command("list","ul");},insertorderedlist:function(D){this.command("list","ol");},list:function(S,W){var F=this.getInstance(),H,R="dir",E="yui3-touched",M,K,L,G,N,P,I,J,U,D,Q=new F.Selection();S="insert"+((W==="ul")?"un":"")+"orderedlist";if(B.UA.ie&&!Q.isCollapsed){K=Q._selection;H=K.htmlText;L=F.Node.create(H);if(L.test("li")||L.one("li")){this._command(S,null);return;}if(L.test(W)){G=K.item?K.item(0):K.parentElement();N=F.one(G);D=N.all("li");P="<div>";D.each(function(X){P+=X.get("innerHTML")+"<br>";});P+="</div>";I=F.Node.create(P);if(N.get("parentNode").test("div")){N=N.get("parentNode");}if(N&&N.hasAttribute(R)){I.setAttribute(R,N.getAttribute(R));}N.replace(I);if(K.moveToElementText){K.moveToElementText(I._node);}K.select();}else{J=B.one(K.parentElement());if(!J.test(F.Selection.BLOCKS)){J=J.ancestor(F.Selection.BLOCKS);}if(J){if(J.hasAttribute(R)){M=J.getAttribute(R);}}if(H.indexOf("<br>")>-1){H=H.split(/<br>/i);}else{var V=F.Node.create(H),O=V.all("p");if(O.size()){H=[];O.each(function(X){H.push(X.get("innerHTML"));});}else{H=[H];}}U="<"+W+' id="ie-list">';B.each(H,function(Y){var X=F.Node.create(Y);if(X.test("p")){if(X.hasAttribute(R)){M=X.getAttribute(R);}Y=X.get("innerHTML");}U+="<li>"+Y+"</li>";});U+="</"+W+">";K.pasteHTML(U);G=F.config.doc.getElementById("ie-list");G.id="";if(M){G.setAttribute(R,M);}if(K.moveToElementText){K.moveToElementText(G);}K.select();}}else{if(B.UA.ie){J=F.one(Q._selection.parentElement());if(J.test("p")){if(J&&J.hasAttribute(R)){M=J.getAttribute(R);}H=B.Selection.getText(J);if(H===""){var T="";if(M){T=' dir="'+M+'"';}U=F.Node.create(B.Lang.sub("<{tag}{dir}><li></li></{tag}>",{tag:W,dir:T}));J.replace(U);Q.selectNode(U.one("li"));}else{this._command(S,null);}}else{this._command(S,null);}}else{F.all(W).addClass(E);if(Q.anchorNode.test(F.Selection.BLOCKS)){J=Q.anchorNode;}else{J=Q.anchorNode.ancestor(F.Selection.BLOCKS);}if(J&&J.hasAttribute(R)){M=J.getAttribute(R);}this._command(S,null);U=F.all(W);if(M){U.each(function(X){if(!X.hasClass(E)){X.setAttribute(R,M);}});}U.removeClass(E);}}},justify:function(I,J){if(B.UA.webkit){var H=this.getInstance(),G=new H.Selection(),D=G.anchorNode;var F=D.getStyle("backgroundColor");this._command(J);G=new H.Selection();if(G.anchorNode.test("div")){var E="<span>"+G.anchorNode.get("innerHTML")+"</span>";G.anchorNode.set("innerHTML",E);G.anchorNode.one("span").setStyle("backgroundColor",F);G.selectNode(G.anchorNode.one("span"));}}else{this._command(J);}},justifycenter:function(D){this.command("justify","justifycenter");},justifyleft:function(D){this.command("justify","justifyleft");},justifyright:function(D){this.command("justify","justifyright");},justifyfull:function(D){this.command("justify","justifyfull");}}});var C=function(I,Q,N){var J=this.getInstance(),O=J.config.doc,G=O.selection.createRange(),F=O.queryCommandValue(I),K,E,H,D,L,P,M;if(F){K=G.htmlText;E=new RegExp(N,"g");H=K.match(E);if(H){K=K.replace(N+";","").replace(N,"");G.pasteHTML('<var id="yui-ie-bs">');D=O.getElementById("yui-ie-bs");L=O.createElement("div");P=O.createElement(Q);L.innerHTML=K;if(D.parentNode!==J.config.doc.body){D=D.parentNode;}M=L.childNodes;D.parentNode.replaceChild(P,D);B.each(M,function(R){P.appendChild(R);});G.collapse();if(G.moveToElementText){G.moveToElementText(P);}G.select();}}this._command(I);};if(B.UA.ie){A.COMMANDS.bold=function(){C.call(this,"bold","b","FONT-WEIGHT: bold");};A.COMMANDS.italic=function(){C.call(this,"italic","i","FONT-STYLE: italic");};A.COMMANDS.underline=function(){C.call(this,"underline","u","TEXT-DECORATION: underline");};}B.namespace("Plugin");B.Plugin.ExecCommand=A;},"@VERSION@",{skinnable:false,requires:["frame"]});YUI.add("editor-tab",function(C){var B=function(){B.superclass.constructor.apply(this,arguments);},A="host";C.extend(B,C.Base,{_onNodeChange:function(E){var D="indent";if(E.changedType==="tab"){if(!E.changedNode.test("li, li *")){E.changedEvent.halt();E.preventDefault();if(E.changedEvent.shiftKey){D="outdent";}this.get(A).execCommand(D,"");}}},initializer:function(){this.get(A).on("nodeChange",C.bind(this._onNodeChange,this));}},{NAME:"editorTab",NS:"tab",ATTRS:{host:{value:false}}});C.namespace("Plugin");C.Plugin.EditorTab=B;},"@VERSION@",{skinnable:false,requires:["editor-base"]});YUI.add("createlink-base",function(B){var A={};A.STRINGS={PROMPT:"Please enter the URL for the link to point to:",DEFAULT:"http://"};B.namespace("Plugin");B.Plugin.CreateLinkBase=A;B.mix(B.Plugin.ExecCommand.COMMANDS,{createlink:function(I){var H=this.get("host").getInstance(),E,C,G,F,D=prompt(A.STRINGS.PROMPT,A.STRINGS.DEFAULT);if(D){F=H.config.doc.createElement("div");D=D.replace(/"/g,"").replace(/'/g,"");D=H.config.doc.createTextNode(D);F.appendChild(D);D=F.innerHTML;this.get("host")._execCommand(I,D);G=new H.Selection();E=G.getSelected();if(!G.isCollapsed&&E.size()){C=E.item(0).one("a");if(C){E.item(0).replace(C);}if(B.UA.gecko){if(C.get("parentNode").test("span")){if(C.get("parentNode").one("br.yui-cursor")){C.get("parentNode").insert(C,"before");}}}}else{this.get("host").execCommand("inserthtml",'<a href="'+D+'">'+D+"</a>");}}return C;}});},"@VERSION@",{skinnable:false,requires:["editor-base"]});YUI.add("editor-base",function(D){var C=function(){C.superclass.constructor.apply(this,arguments);},B=":last-child",A="body";D.extend(C,D.Base,{frame:null,initializer:function(){var E=new D.Frame({designMode:true,title:C.STRINGS.title,use:C.USE,dir:this.get("dir"),extracss:this.get("extracss"),linkedcss:this.get("linkedcss"),defaultblock:this.get("defaultblock"),host:this}).plug(D.Plugin.ExecCommand);
E.after("ready",D.bind(this._afterFrameReady,this));E.addTarget(this);this.frame=E;this.publish("nodeChange",{emitFacade:true,bubbles:true,defaultFn:this._defNodeChangeFn});},destructor:function(){this.frame.destroy();this.detachAll();},copyStyles:function(H,G){if(H.test("a")){return;}var E=["color","fontSize","fontFamily","backgroundColor","fontStyle"],F={};D.each(E,function(I){F[I]=H.getStyle(I);});if(H.ancestor("b,strong")){F.fontWeight="bold";}if(H.ancestor("u")){if(!F.textDecoration){F.textDecoration="underline";}}G.setStyles(F);},_lastBookmark:null,_resolveChangedNode:function(I){var H=this.getInstance(),F,E,G;if(H&&I&&I.test("html")){F=H.one(A).one(B);while(!G){if(F){E=F.one(B);if(E){F=E;}else{G=true;}}else{G=true;}}if(F){if(F.test("br")){if(F.previous()){F=F.previous();}else{F=F.get("parentNode");}}if(F){I=F;}}}return I;},_defNodeChangeFn:function(R){var I=(new Date()).getTime();var P=this.getInstance(),H,S,O=P.Selection.DEFAULT_BLOCK_TAG;if(D.UA.ie){try{H=P.config.doc.selection.createRange();if(H.getBookmark){this._lastBookmark=H.getBookmark();}}catch(F){}}R.changedNode=this._resolveChangedNode(R.changedNode);switch(R.changedType){case"keydown":if(!D.UA.gecko){if(!C.NC_KEYS[R.changedEvent.keyCode]&&!R.changedEvent.shiftKey&&!R.changedEvent.ctrlKey&&(R.changedEvent.keyCode!==13)){}}break;case"tab":if(!R.changedNode.test("li, li *")&&!R.changedEvent.shiftKey){R.changedEvent.frameEvent.preventDefault();if(D.UA.webkit){this.execCommand("inserttext","\t");}else{if(D.UA.gecko){this.frame.exec._command("inserthtml",C.TABKEY);}else{if(D.UA.ie){H=new P.Selection();if(H._selection.pasteHTML){H._selection.pasteHTML(C.TABKEY);}else{console.log("IE9 is here.. SHould be default behaviour now");this.execCommand("inserthtml",C.TABKEY);}}}}}break;}if(D.UA.webkit&&R.commands&&(R.commands.indent||R.commands.outdent)){var T=P.all(".webkit-indent-blockquote");if(T.size()){T.setStyle("margin","");}}var N=this.getDomPath(R.changedNode,false),E={},M,G,K=[],L="",J="";if(R.commands){E=R.commands;}D.each(N,function(Z){var V=Z.tagName.toLowerCase(),a=C.TAG2CMD[V];if(a){E[a]=1;}var Y=Z.currentStyle||Z.style;if((""+Y.fontWeight)=="bold"){E.bold=1;}if(D.UA.ie){if(Y.fontWeight>400){E.bold=1;}}if(Y.fontStyle=="italic"){E.italic=1;}if(Y.textDecoration=="underline"){E.underline=1;}if(Y.textDecoration=="line-through"){E.strikethrough=1;}var b=P.one(Z);if(b.getStyle("fontFamily")){var X=b.getStyle("fontFamily").split(",")[0].toLowerCase();if(X){M=X;}if(M){M=M.replace(/'/g,"").replace(/"/g,"");}}G=C.NORMALIZE_FONTSIZE(b);var W=Z.className.split(" ");D.each(W,function(c){if(c!==""&&(c.substr(0,4)!=="yui_")){K.push(c);}});L=C.FILTER_RGB(b.getStyle("color"));var U=C.FILTER_RGB(Y.backgroundColor);if(U!=="transparent"){if(U!==""){J=U;}}});R.dompath=P.all(N);R.classNames=K;R.commands=E;if(!R.fontFamily){R.fontFamily=M;}if(!R.fontSize){R.fontSize=G;}if(!R.fontColor){R.fontColor=L;}if(!R.backgroundColor){R.backgroundColor=J;}var Q=(new Date()).getTime();},getDomPath:function(G,E){var I=[],F,H=this.frame.getInstance();F=H.Node.getDOMNode(G);while(F!==null){if((F===H.config.doc.documentElement)||(F===H.config.doc)||!F.tagName){F=null;break;}if(!H.DOM.inDoc(F)){F=null;break;}if(F.nodeName&&F.nodeType&&(F.nodeType==1)){I.push(F);}if(F==H.config.doc.body){F=null;break;}F=F.parentNode;}if(I.length===0){I[0]=H.config.doc.body;}if(E){return H.all(I.reverse());}else{return I.reverse();}},_afterFrameReady:function(){var E=this.frame.getInstance();this.frame.on("dom:mouseup",D.bind(this._onFrameMouseUp,this));this.frame.on("dom:mousedown",D.bind(this._onFrameMouseDown,this));this.frame.on("dom:keydown",D.bind(this._onFrameKeyDown,this));if(D.UA.ie){this.frame.on("dom:activate",D.bind(this._onFrameActivate,this));this.frame.on("dom:beforedeactivate",D.bind(this._beforeFrameDeactivate,this));}this.frame.on("dom:keyup",D.bind(this._onFrameKeyUp,this));this.frame.on("dom:keypress",D.bind(this._onFrameKeyPress,this));this.frame.on("dom:paste",D.bind(this._onPaste,this));E.Selection.filter();this.fire("ready");},_beforeFrameDeactivate:function(G){if(G.frameTarget.test("html")){return;}var F=this.getInstance(),E=F.config.doc.selection.createRange();if(E.compareEndPoints&&!E.compareEndPoints("StartToEnd",E)){E.pasteHTML('<var id="yui-ie-cursor">');}},_onFrameActivate:function(H){if(H.frameTarget.test("html")){return;}var G=this.getInstance(),F=new G.Selection(),E=F.createRange(),I=G.all("#yui-ie-cursor");if(I.size()){I.each(function(L){L.set("id","");if(E.moveToElementText){try{E.moveToElementText(L._node);var J=E.move("character",-1);if(J===-1){E.move("character",1);}E.select();E.text="";}catch(K){}}L.remove();});}},_onPaste:function(E){this.fire("nodeChange",{changedNode:E.frameTarget,changedType:"paste",changedEvent:E.frameEvent});},_onFrameMouseUp:function(E){this.fire("nodeChange",{changedNode:E.frameTarget,changedType:"mouseup",changedEvent:E.frameEvent});},_onFrameMouseDown:function(E){this.fire("nodeChange",{changedNode:E.frameTarget,changedType:"mousedown",changedEvent:E.frameEvent});},_currentSelection:null,_currentSelectionTimer:null,_currentSelectionClear:null,_onFrameKeyDown:function(G){var F,E;if(!this._currentSelection){if(this._currentSelectionTimer){this._currentSelectionTimer.cancel();}this._currentSelectionTimer=D.later(850,this,function(){this._currentSelectionClear=true;});F=this.frame.getInstance();E=new F.Selection(G);this._currentSelection=E;}else{E=this._currentSelection;}F=this.frame.getInstance();E=new F.Selection();this._currentSelection=E;if(E&&E.anchorNode){this.fire("nodeChange",{changedNode:E.anchorNode,changedType:"keydown",changedEvent:G.frameEvent});if(C.NC_KEYS[G.keyCode]){this.fire("nodeChange",{changedNode:E.anchorNode,changedType:C.NC_KEYS[G.keyCode],changedEvent:G.frameEvent});this.fire("nodeChange",{changedNode:E.anchorNode,changedType:C.NC_KEYS[G.keyCode]+"-down",changedEvent:G.frameEvent});}}},_onFrameKeyPress:function(F){var E=this._currentSelection;if(E&&E.anchorNode){this.fire("nodeChange",{changedNode:E.anchorNode,changedType:"keypress",changedEvent:F.frameEvent});
if(C.NC_KEYS[F.keyCode]){this.fire("nodeChange",{changedNode:E.anchorNode,changedType:C.NC_KEYS[F.keyCode]+"-press",changedEvent:F.frameEvent});}}},_onFrameKeyUp:function(G){var F=this.frame.getInstance(),E=new F.Selection(G);if(E&&E.anchorNode){this.fire("nodeChange",{changedNode:E.anchorNode,changedType:"keyup",selection:E,changedEvent:G.frameEvent});if(C.NC_KEYS[G.keyCode]){this.fire("nodeChange",{changedNode:E.anchorNode,changedType:C.NC_KEYS[G.keyCode]+"-up",selection:E,changedEvent:G.frameEvent});}}if(this._currentSelectionClear){this._currentSelectionClear=this._currentSelection=null;}},execCommand:function(I,K){var F=this.frame.execCommand(I,K),H=this.frame.getInstance(),G=new H.Selection(),E={},J={changedNode:G.anchorNode,changedType:"execcommand",nodes:F};switch(I){case"forecolor":J.fontColor=K;break;case"backcolor":J.backgroundColor=K;break;case"fontsize":J.fontSize=K;break;case"fontname":J.fontFamily=K;break;}E[I]=1;J.commands=E;this.fire("nodeChange",J);return F;},getInstance:function(){return this.frame.getInstance();},render:function(E){this.frame.set("content",this.get("content"));this.frame.render(E);return this;},focus:function(E){this.frame.focus(E);return this;},show:function(){this.frame.show();return this;},hide:function(){this.frame.hide();return this;},getContent:function(){var E="",F=this.getInstance();if(F&&F.Selection){E=F.Selection.unfilter();}E=E.replace(/ _yuid="([^>]*)"/g,"");return E;}},{NORMALIZE_FONTSIZE:function(G){var E=G.getStyle("fontSize"),F=E;switch(E){case"-webkit-xxx-large":E="48px";break;case"xx-large":E="32px";break;case"x-large":E="24px";break;case"large":E="18px";break;case"medium":E="16px";break;case"small":E="13px";break;case"x-small":E="10px";break;}if(F!==E){G.setStyle("fontSize",E);}return E;},TABKEY:'<span class="tab">&nbsp;&nbsp;&nbsp;&nbsp;</span>',FILTER_RGB:function(G){if(G.toLowerCase().indexOf("rgb")!=-1){var J=new RegExp("(.*?)rgb\\s*?\\(\\s*?([0-9]+).*?,\\s*?([0-9]+).*?,\\s*?([0-9]+).*?\\)(.*?)","gi");var F=G.replace(J,"$1,$2,$3,$4,$5").split(",");if(F.length==5){var I=parseInt(F[1],10).toString(16);var H=parseInt(F[2],10).toString(16);var E=parseInt(F[3],10).toString(16);I=I.length==1?"0"+I:I;H=H.length==1?"0"+H:H;E=E.length==1?"0"+E:E;G="#"+I+H+E;}}return G;},TAG2CMD:{"b":"bold","strong":"bold","i":"italic","em":"italic","u":"underline","sup":"superscript","sub":"subscript","img":"insertimage","a":"createlink","ul":"insertunorderedlist","ol":"insertorderedlist"},NC_KEYS:{8:"backspace",9:"tab",13:"enter",32:"space",33:"pageup",34:"pagedown",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down",46:"delete"},USE:["substitute","node","selector-css3","selection","stylesheet"],NAME:"editorBase",STRINGS:{title:"Rich Text Editor"},ATTRS:{content:{value:'<br class="yui-cursor">',setter:function(E){if(E.substr(0,1)==="\n"){E=E.substr(1);}if(E===""){E='<br class="yui-cursor">';}if(E===" "){if(D.UA.gecko){E='<br class="yui-cursor">';}}return this.frame.set("content",E);},getter:function(){return this.frame.get("content");}},dir:{writeOnce:true,value:"ltr"},linkedcss:{value:"",setter:function(E){if(this.frame){this.frame.set("linkedcss",E);}return E;}},extracss:{value:false,setter:function(E){if(this.frame){this.frame.set("extracss",E);}return E;}},defaultblock:{value:"p"}}});D.EditorBase=C;},"@VERSION@",{skinnable:false,requires:["base","frame","node","exec-command","selection","editor-para"]});YUI.add("editor-lists",function(F){var E=function(){E.superclass.constructor.apply(this,arguments);},B="li",C="ol",D="ul",A="host";F.extend(E,F.Base,{_onNodeChange:function(L){var J=this.get(A).getInstance(),G,O,P,H,I,M,N=false,Q,K=false;if(L.changedType==="tab"){if(L.changedNode.test(B+", "+B+" *")){L.changedEvent.halt();L.preventDefault();O=L.changedNode;I=L.changedEvent.shiftKey;M=O.ancestor(C+","+D);Q=D;if(M.get("tagName").toLowerCase()===C){Q=C;}if(!O.test(B)){O=O.ancestor(B);}if(I){if(O.ancestor(B)){O.ancestor(B).insert(O,"after");N=true;K=true;}}else{if(O.previous(B)){H=J.Node.create("<"+Q+"></"+Q+">");O.previous(B).append(H);H.append(O);N=true;}}}if(N){if(!O.test(B)){O=O.ancestor(B);}O.all(E.REMOVE).remove();if(F.UA.ie){O=O.append(E.NON).one(E.NON_SEL);}(new J.Selection()).selectNode(O,true,K);}}},initializer:function(){this.get(A).on("nodeChange",F.bind(this._onNodeChange,this));}},{NON:'<span class="yui-non">&nbsp;</span>',NON_SEL:"span.yui-non",REMOVE:"br",NAME:"editorLists",NS:"lists",ATTRS:{host:{value:false}}});F.namespace("Plugin");F.Plugin.EditorLists=E;},"@VERSION@",{skinnable:false,requires:["editor-base"]});YUI.add("editor-bidi",function(A){var B=function(){B.superclass.constructor.apply(this,arguments);},I="host",H="dir",F="BODY",D="nodeChange",E="bidiContextChange",C=F+" > p",G="style";A.extend(B,A.Base,{lastDirection:null,firstEvent:null,_checkForChange:function(){var K=this.get(I),M=K.getInstance(),L=new M.Selection(),J,N;if(L.isCollapsed){J=B.blockParent(L.focusNode);if(J){N=J.getStyle("direction");if(N!==this.lastDirection){K.fire(E,{changedTo:N});this.lastDirection=N;}}}else{K.fire(E,{changedTo:"select"});this.lastDirection=null;}},_afterNodeChange:function(J){if(this.firstEvent||B.EVENTS[J.changedType]){this._checkForChange();this.firstEvent=false;}},_afterMouseUp:function(J){this._checkForChange();this.firstEvent=false;},initializer:function(){var J=this.get(I);this.firstEvent=true;J.after(D,A.bind(this._afterNodeChange,this));J.after("dom:mouseup",A.bind(this._afterMouseUp,this));}},{EVENTS:{"backspace-up":true,"pageup-up":true,"pagedown-down":true,"end-up":true,"home-up":true,"left-up":true,"up-up":true,"right-up":true,"down-up":true,"delete-up":true},BLOCKS:A.Selection.BLOCKS,DIV_WRAPPER:"<DIV></DIV>",blockParent:function(L,K){var J=L,N,M;if(!J){J=A.one(F);}if(!J.test(B.BLOCKS)){J=J.ancestor(B.BLOCKS);}if(K&&J.test(F)){N=A.Node.create(B.DIV_WRAPPER);J.get("children").each(function(P,O){if(O===0){M=P;}else{N.append(P);}});M.replace(N);N.prepend(M);J=N;}return J;},_NODE_SELECTED:"bidiSelected",addParents:function(M){var J,L,K;
for(J=0;J<M.length;J+=1){M[J].setData(B._NODE_SELECTED,true);}for(J=0;J<M.length;J+=1){L=M[J].get("parentNode");if(!L.test(F)&&!L.getData(B._NODE_SELECTED)){K=true;L.get("children").some(function(N){if(!N.getData(B._NODE_SELECTED)){K=false;return true;}});if(K){M.push(L);L.setData(B._NODE_SELECTED,true);}}}for(J=0;J<M.length;J+=1){M[J].clearData(B._NODE_SELECTED);}return M;},NAME:"editorBidi",NS:"editorBidi",ATTRS:{host:{value:false}},RE_TEXT_ALIGN:/text-align:\s*\w*\s*;/,removeTextAlign:function(J){if(J){if(J.getAttribute(G).match(B.RE_TEXT_ALIGN)){J.setAttribute(G,J.getAttribute(G).replace(B.RE_TEXT_ALIGN,""));}if(J.hasAttribute("align")){J.removeAttribute("align");}}return J;}});A.namespace("Plugin");A.Plugin.EditorBidi=B;A.Plugin.ExecCommand.COMMANDS.bidi=function(M,S){var P=this.getInstance(),K=new P.Selection(),R=this.get(I).get(I).editorBidi,J,N,O,T,L;if(!R){A.error("bidi execCommand is not available without the EditorBiDi plugin.");return;}P.Selection.filterBlocks();if(K.anchorNode.test(F)){return;}if(K.isCollapsed){N=B.blockParent(K.anchorNode);N=B.removeTextAlign(N);if(!S){L=N.getAttribute(H);if(!L||L=="ltr"){S="rtl";}else{S="ltr";}}N.setAttribute(H,S);if(A.UA.ie){var Q=N.all("br.yui-cursor");if(Q.size()===1&&N.get("childNodes").size()==1){Q.remove();}}J=N;}else{O=K.getSelected();T=[];O.each(function(U){T.push(B.blockParent(U));});T=P.all(B.addParents(T));T.each(function(V){var U=S;V=B.removeTextAlign(V);if(!U){L=V.getAttribute(H);if(!L||L=="ltr"){U="rtl";}else{U="ltr";}}V.setAttribute(H,U);});J=T;}R._checkForChange();return J;};},"@VERSION@",{skinnable:false,requires:["editor-base"]});YUI.add("editor-para",function(A){var D=function(){D.superclass.constructor.apply(this,arguments);},K="host",F="body",C="nodeChange",J="parentNode",B=F+" > p",H="p",G="<br>",I="firstChild",E="li";A.extend(D,A.Base,{_fixFirstPara:function(){var O=this.get(K),Q=O.getInstance(),P,R,L=Q.config.doc.body,N=L.innerHTML,M=((N.length)?true:false);if(N===G){N="";M=false;}L.innerHTML="<"+H+">"+N+Q.Selection.CURSOR+"</"+H+">";R=Q.one(B);P=new Q.Selection();P.selectNode(R,true,M);},_onNodeChange:function(s){var f=this.get(K),O=f.getInstance(),U,a,Z,v,o,h=O.Selection.DEFAULT_BLOCK_TAG,W,N,Q,q,S,L,g,l,R,m,x,u,j,Y,X,r=":last-child";switch(s.changedType){case"enter-up":var M=((this._lastPara)?this._lastPara:s.changedNode),w=M.one("br.yui-cursor");if(this._lastPara){delete this._lastPara;}if(w){if(w.previous()||w.next()){if(w.ancestor(H)){w.remove();}}}if(!M.test(h)){var c=M.ancestor(h);if(c){M=c;c=null;}}if(M.test(h)){var i=M.previous(),k,T,V=false;if(i){k=i.one(r);while(!V){if(k){T=k.one(r);if(T){k=T;}else{V=true;}}else{V=true;}}if(k){f.copyStyles(k,M);}}}break;case"enter":if(A.UA.ie){if(s.changedNode.test("br")){s.changedNode.remove();}else{if(s.changedNode.test("p, span")){var w=s.changedNode.one("br.yui-cursor");if(w){w.remove();}}}}if(A.UA.webkit){if(s.changedEvent.shiftKey){f.execCommand("insertbr");s.changedEvent.preventDefault();}}if(A.UA.gecko&&f.get("defaultblock")!=="p"){Z=s.changedNode;if(!Z.test(E)&&!Z.ancestor(E)){if(!Z.test(h)){Z=Z.ancestor(h);}v=O.Node.create("<"+h+"></"+h+">");Z.insert(v,"after");o=new O.Selection();if(o.anchorOffset){W=o.anchorNode.get("textContent");a=O.one(O.config.doc.createTextNode(W.substr(0,o.anchorOffset)));N=O.one(O.config.doc.createTextNode(W.substr(o.anchorOffset)));q=o.anchorNode;q.setContent("");L=q.cloneNode();L.append(N);g=false;R=q;while(!g){R=R.get(J);if(R&&!R.test(h)){l=R.cloneNode();l.set("innerHTML","");l.append(L);Q=R.get("childNodes");var P=false;Q.each(function(b){if(P){l.append(b);}if(b===q){P=true;}});q=R;L=l;}else{g=true;}}N=L;o.anchorNode.append(a);if(N){v.append(N);}}if(v.get(I)){v=v.get(I);}v.prepend(O.Selection.CURSOR);o.focusCursor(true,true);U=O.Selection.getText(v);if(U!==""){O.Selection.cleanCursor();}s.changedEvent.preventDefault();}}break;case"keyup":if(A.UA.gecko){if(O.config.doc&&O.config.doc.body&&O.config.doc.body.innerHTML.length<2){this._fixFirstPara();}}break;case"backspace-up":case"backspace-down":case"delete-up":if(!A.UA.ie){m=O.all(B);u=O.one(F);if(m.item(0)){u=m.item(0);}x=u.one("br");if(x){x.removeAttribute("id");x.removeAttribute("class");}a=O.Selection.getText(u);a=a.replace(/ /g,"").replace(/\n/g,"");Y=u.all("img");if(a.length===0&&!Y.size()){if(!u.test(H)){this._fixFirstPara();}j=null;if(s.changedNode&&s.changedNode.test(H)){j=s.changedNode;}if(!j&&f._lastPara&&f._lastPara.inDoc()){j=f._lastPara;}if(j&&!j.test(H)){j=j.ancestor(H);}if(j){if(!j.previous()&&j.get(J)&&j.get(J).test(F)){s.changedEvent.frameEvent.halt();}}}if(A.UA.webkit){if(s.changedNode){u=s.changedNode;if(u.test("li")&&(!u.previous()&&!u.next())){U=u.get("innerHTML").replace(G,"");if(U===""){if(u.get(J)){u.get(J).replace(O.Node.create(G));s.changedEvent.frameEvent.halt();s.preventDefault();O.Selection.filterBlocks();}}}}}}if(A.UA.gecko){v=s.changedNode;X=O.config.doc.createTextNode(" ");v.appendChild(X);v.removeChild(X);}break;}if(A.UA.gecko){if(s.changedNode&&!s.changedNode.test(h)){j=s.changedNode.ancestor(h);if(j){this._lastPara=j;}}}},_afterEditorReady:function(){var M=this.get(K),N=M.getInstance(),L;if(N){N.Selection.filterBlocks();L=N.Selection.DEFAULT_BLOCK_TAG;B=F+" > "+L;H=L;}},_afterContentChange:function(){var L=this.get(K),M=L.getInstance();if(M&&M.Selection){M.Selection.filterBlocks();}},_afterPaste:function(){var L=this.get(K),N=L.getInstance(),M=new N.Selection();A.later(50,L,function(){N.Selection.filterBlocks();});},initializer:function(){var L=this.get(K);if(L.editorBR){A.error("Can not plug EditorPara and EditorBR at the same time.");return;}L.on(C,A.bind(this._onNodeChange,this));L.after("ready",A.bind(this._afterEditorReady,this));L.after("contentChange",A.bind(this._afterContentChange,this));if(A.Env.webkit){L.after("dom:paste",A.bind(this._afterPaste,this));}}},{NAME:"editorPara",NS:"editorPara",ATTRS:{host:{value:false}}});A.namespace("Plugin");A.Plugin.EditorPara=D;},"@VERSION@",{skinnable:false,requires:["node"]});YUI.add("editor-br",function(C){var D=function(){D.superclass.constructor.apply(this,arguments);
},A="host",B="li";C.extend(D,C.Base,{_onKeyDown:function(I){if(I.stopped){I.halt();return;}if(I.keyCode==13){var F=this.get(A),H=F.getInstance(),G=new H.Selection(),E="";if(G){if(C.UA.ie){if(!G.anchorNode||(!G.anchorNode.test(B)&&!G.anchorNode.ancestor(B))){G._selection.pasteHTML("<br>");G._selection.collapse(false);G._selection.select();I.halt();}}if(C.UA.webkit){if(!G.anchorNode.test(B)&&!G.anchorNode.ancestor(B)){F.frame._execCommand("insertlinebreak",null);I.halt();}}}}},_afterEditorReady:function(){var E=this.get(A).getInstance();try{E.config.doc.execCommand("insertbronreturn",null,true);}catch(F){}if(C.UA.ie||C.UA.webkit){E.on("keydown",C.bind(this._onKeyDown,this),E.config.doc);}},_onNodeChange:function(G){switch(G.changedType){case"backspace-up":case"backspace-down":case"delete-up":var F=this.get(A).getInstance();var H=G.changedNode;var E=F.config.doc.createTextNode(" ");H.appendChild(E);H.removeChild(E);break;}},initializer:function(){var E=this.get(A);if(E.editorPara){C.error("Can not plug EditorBR and EditorPara at the same time.");return;}E.after("ready",C.bind(this._afterEditorReady,this));if(C.UA.gecko){E.on("nodeChange",C.bind(this._onNodeChange,this));}}},{NAME:"editorBR",NS:"editorBR",ATTRS:{host:{value:false}}});C.namespace("Plugin");C.Plugin.EditorBR=D;},"@VERSION@",{skinnable:false,requires:["node"]});YUI.add("editor",function(A){},"@VERSION@",{skinnable:false,use:["frame","selection","exec-command","editor-base","editor-para","editor-br","editor-bidi","createlink-base"]});