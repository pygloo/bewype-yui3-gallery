YUI.add("history-deprecated",function(a){var c=a.config.win,s=a.config.doc,d=encodeURIComponent,m=decodeURIComponent,h,i,p="Missing or invalid argument",k=/([^=&]+)=([^&]*)/g,b=false,l,j="history:ready",o="history:globalStateChange",f="history:moduleStateChange";i=YUI.Env.history||{ready:false,_modules:[],_stateField:null,_historyIFrame:null};YUI.Env.history=i;if(a.UA.gecko){l=function(){var t=/#(.*)$/.exec(c.location.href);return t&&t[1]?t[1]:"";};}else{l=function(){return c.location.hash.substr(1);};}function q(){var u=[],t=[];a.Object.each(i._modules,function(v,w){u.push(w+"="+v.initialState);t.push(w+"="+v.currentState);});i._stateField.set("value",u.join("&")+"|"+t.join("&"));}function n(w){var t,v=[],u=false;if(w){k.lastIndex=0;while((t=k.exec(w))){v[t[1]]=t[2];}a.Object.each(i._modules,function(x,z){var y=v[z];if(!y||x.currentState!==y){x.currentState=y||x.initialState;x.fire(f,m(x.currentState));u=true;}});}else{a.Object.each(i._modules,function(x,y){if(x.currentState!==x.initialState){x.currentState=x.initialState;x.fire(f,m(x.currentState));u=true;}});}if(u){h.fire(o);}}function g(w){var t,v;t="<html><body>"+w.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")+"</body></html>";try{v=i._historyIFrame.get("contentWindow.document");v.invoke("open");v.invoke("write",t,"","","","");v.invoke("close");return true;}catch(u){return false;}}function e(){var t,v,u;if(!i._historyIFrame.get("contentWindow.document")){setTimeout(e,10);return;}t=i._historyIFrame.get("contentWindow.document.body");v=t?t.get("innerText"):null;u=l();setInterval(function(){var y,w,x;t=i._historyIFrame.get("contentWindow.document.body");y=t?t.get("innerText"):null;x=l();if(y!==v){v=y;n(v);if(!v){w=[];a.Object.each(i._modules,function(z,A){w.push(A+"="+z.initialState);});x=w.join("&");}else{x=v;}c.location.hash=u=x;q();}else{if(x!==u){u=x;g(x);}}},50);i.ready=true;h.fire(j);}function r(){var u,z,x,v,t,w,y;z=i._stateField.get("value").split("|");if(z.length>1){k.lastIndex=0;while((u=k.exec(z[0]))){x=u[1];t=u[2];v=i._modules[x];if(v){v.initialState=t;}}k.lastIndex=0;while((u=k.exec(z[1]))){x=u[1];w=u[2];v=i._modules[x];if(v){v.currentState=w;}}}if(!a.Lang.isUndefined(c.onhashchange)&&(a.Lang.isUndefined(s.documentMode)||s.documentMode>7)){c.onhashchange=function(){var A=l();n(A);q();};i.ready=true;h.fire(j);}else{if(b){e();}else{y=l();setInterval(function(){var A=l();if(A!==y){y=A;n(y);q();}},50);i.ready=true;h.fire(j);}}}h=a.mix(new a.EventTarget(),{register:function(v,t){var u;if(!a.Lang.isString(v)||a.Lang.trim(v)===""||!a.Lang.isString(t)){throw new Error(p);}v=d(v);t=d(t);if(i._modules[v]){return;}if(i.ready){return null;}u=new h.Module(v,t);i._modules[v]=u;return u;},initialize:function(t,w){var u,v;if(i.ready){return true;}t=a.one(t);if(!t){throw new Error(p);}u=t.get("tagName").toUpperCase();v=t.get("type");if(u!=="TEXTAREA"&&(u!=="INPUT"||v!=="hidden"&&v!=="text")){throw new Error(p);}if(a.UA.ie&&(a.Lang.isUndefined(s.documentMode)||s.documentMode<8)){b=true;w=a.one(w);if(!w||w.get("tagName").toUpperCase()!=="IFRAME"){throw new Error(p);}}if(a.UA.opera&&!a.Lang.isUndefined(c.history.navigationMode)){c.history.navigationMode="compatible";}i._stateField=t;i._historyIFrame=w;a.on("domready",r);return true;},navigate:function(u,v){var t;if(!a.Lang.isString(u)||!a.Lang.isString(v)){throw new Error(p);}t={};t[u]=v;return h.multiNavigate(t);},multiNavigate:function(u){var v=[],w,t=false;if(!i.ready){return false;}a.Object.each(i._modules,function(y,z){var A,x=m(z);if(!u.hasOwnProperty(x)){A=y.currentState;}else{A=d(u[x]);if(A!==y.upcomingState){y.upcomingState=A;t=true;}}v.push(z+"="+A);});if(!t){return false;}w=v.join("&");if(b){return g(w);}else{c.location.hash=w;return true;}},getCurrentState:function(u){var t;if(!a.Lang.isString(u)){throw new Error(p);}if(!i.ready){return null;}u=d(u);t=i._modules[u];if(!t){return null;}return m(t.currentState);},getBookmarkedState:function(w){var t,u,v;if(!a.Lang.isString(w)){throw new Error(p);}w=d(w);v=c.location.href;u=v.indexOf("#");if(u>=0){v=v.substr(u+1);k.lastIndex=0;while((t=k.exec(v))){if(t[1]===w){return m(t[2]);}}}return null;},getQueryStringParameter:function(x,u){var t,w,v;u=u||c.location.href;v=u.indexOf("?");w=v>=0?u.substr(v+1):u;v=w.lastIndexOf("#");w=v>=0?w.substr(0,v):w;k.lastIndex=0;while((t=k.exec(w))){if(t[1]===x){return m(t[2]);}}return null;}});h.Module=function(u,t){this.id=u;this.initialState=t;this.currentState=t;this.upcomingState=t;};a.augment(h.Module,a.EventTarget);a.History=h;},"@VERSION@",{requires:["node-base"],skinnable:false});