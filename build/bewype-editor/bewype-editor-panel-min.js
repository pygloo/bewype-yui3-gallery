YUI.add("bewype-editor-panel",function(D){var B="",A="",C=null;B+='<div class="{editorClass} {buttonClass}">';B+="</div>";A+='<div class="{editorClass} {buttonClass}">';A+='<div class="{editorClass}-label {buttonClass}-label">{label}</div>';A+='<div class="{spinnerClass}"></div>';A+="</div>";C=function(E){C.superclass.constructor.apply(this,arguments);};C.NAME="bewype-editor-panel";C.NS="bewypeEditorPanel";D.extend(C,D.Bewype.EditorConfig,{_buttonDict:{},_editors:[],_spinnerButtons:["height","width","padding-top","padding-right","padding-bottom","padding-left"],_toggleButtons:["bold","italic","underline"],_pickerButtons:["title","font-family","font-size","text-align","color","background-color","url","file"],_pickerObjDict:{"background-color":D.Bewype.PickerColor,"color":D.Bewype.PickerColor,"file":D.Bewype.PickerFile,"font-family":D.Bewype.PickerFontFamily,"font-size":D.Bewype.PickerFontSize,"text-align":D.Bewype.PickerTextAlign,"title":D.Bewype.PickerTitle,"url":D.Bewype.PickerUrl},_tagButtons:["bold","italic","title","underline","url"],_cssButtons:["font-family","font-size","text-align","color","background-color","padding-top","padding-right","padding-bottom","padding-left"],_addSpinnerButton:function(E,F){var J=this.get("host"),I=this.get("editorClass")+"-button",G=this.get("editorClass")+"-spinner-"+E,L=null,K=null,H=F.spinnerValues[E],M=H?parseInt(H.replace(/px/i,""),10):0;L=new D.Node.create(D.substitute(A,{editorClass:I,buttonClass:I+"-button-"+E,label:this.get(D.Bewype.Utils.camelize("spinner-label-"+E)),spinnerClass:G}));J.append(L);K=new D.Bewype.EntrySpinner({srcNode:L.one("."+G),max:this.get(D.Bewype.Utils.camelize("spinner-max-"+E)),min:0,value:M});K.render();K.on("entry:onChange",D.bind(this._onSpinnerChange,this,E));this._buttonDict[E]=K;return{height:D.Bewype.Utils.getHeight(L),width:D.Bewype.Utils.getWidth(L)};},__buttonFactory:function(G,F,J){var I=this.get("host"),K=this.get("editorClass"),L=null,E=null,H=null;L=new D.Node.create(D.substitute(B,{editorClass:K+"-button",buttonClass:K+"-button-"+G}));I.append(L);J.render(L);if(F==="button"){E="button:onClick";}else{E="button:onChange";}J.on(E,D.bind(this._onButtonChange,this,G));if(this._pickerButtons.indexOf(G)!=-1){H="button:onClick";J.before(H,D.bind(this._onButtonClick,this,G));}this._buttonDict[G]=J;return{height:D.Bewype.Utils.getHeight(L),width:D.Bewype.Utils.getWidth(L)};},_addButton:function(E){var F=new D.Bewype.Button({label:E});return this.__buttonFactory(E,"button",F);},_addToggleButton:function(E){var F=new D.Bewype.ButtonToggle({label:E});return this.__buttonFactory(E,"toggle-button",F);},_addPickerButton:function(F,H){var E=F==="background-color"||F==="color",I={fileStaticPath:F==="file"?this.get("fileStaticPath"):null,uploadUrl:F==="file"?this.get("uploadUrl"):null,pickerSize:E?this.get("pickerColorSize"):null},G=new D.Bewype.ButtonPicker({label:F,pickerObj:H,pickerParams:I,pickerPosition:this.get("panelPosition")});return this.__buttonFactory(F,"picker-button",G);},_initPanel:function(F){var M=this.get("host"),K=this.get("editorClass"),J=this.get("panelPosition"),I=this.get("panelOffsetX"),H=this.get("panelOffsetY"),E=this.get("activeButtons"),L=null,N=this.get("panelPadding"),O=0,G=0;D.Object.each(this._spinnerButtons,function(Q,P){var R=null;if(E.indexOf(Q)!=-1){R=this._addSpinnerButton(Q,F);O+=R.height+4;G+=R.width+4;}},this);this.updateSpinnerMaxWidth();D.Object.each(this._toggleButtons,function(Q,P){var R=null;if(E.indexOf(Q)!=-1){R=this._addToggleButton(Q);O+=R.height+4;G+=R.width+4;}},this);D.Object.each(this._pickerButtons,function(Q,P){var R=null;if(E.indexOf(Q)!=-1){R=this._addPickerButton(Q,this._pickerObjDict[Q]);O+=R.height+4;G+=R.width+4;}},this);L=this._addButton("reset");O+=L.height;G+=L.width;L=this._addButton("apply");O+=L.height;G+=L.width;O+=N;G+=N;M.addClass(K);M.addClass(K+"-"+J);M.setStyle("display","block");M.setStyle(J,I);M.setStyle("top",H);if(J==="left"||J==="right"){M.setStyle("height",O);}else{M.setStyle("width",G);}},initializer:function(E){this._initPanel(E);D.publish("bewype-editor:onClose");D.publish("bewype-editor:onChange");},destructor:function(){var E=this.get("host"),F=this.get("editorClass"),G=this.get("panelPosition");E.removeClass(F);E.removeClass(F+"-"+G);E.setStyle("display","none");D.Object.each(this.get("activeButtons"),function(I,H){this._buttonDict[I].destroy();delete (this._buttonDict[I]);},this);E.all("."+F+"-button").each(function(I,H){I.remove();});D.Object.each(this._editors,function(I,H){if(I.bewypeEditorTag){I.unplug(D.Bewype.EditorTag);}else{if(I.bewypeEditorText){I.unplug(D.Bewype.EditorText);}else{return;}}this.unRegisterEditor(I);},this);},registerEditor:function(E){if(this._editors.indexOf(E)==-1){this._editors.push(E);}},unRegisterEditor:function(E){var F=this._editors.indexOf(E);if(F!=-1){this._editors.splice(F,1);}},getWorkingTagName:function(F,G){switch(F){case"bold":return"b";case"italic":return"i";case"title":var H=this._buttonDict[F],E=G?H.getPrevious():H.getValue();return E==="normal"?null:E;case"underline":return"u";case"url":return"a";default:return"span";}},getButton:function(E){return this._buttonDict[E];},isCssButton:function(E){return this._cssButtons.indexOf(E)!=-1;},_getStyleValue:function(G,F){if(!G){return null;}else{if(F==="url"){return G.get("href");}else{var E=D.Bewype.Utils.getCssDict(G);return E[F];}}},refreshButtons:function(G,F,E){if(!G){return;}var H=E?[E]:this.get("activeButtons");D.Object.each(H,function(K,J){if(this.get("activeButtons").indexOf(K)===-1){return;}var I=null;switch(K){case"bold":I=F?false:G.one("b")!==null;return this._buttonDict[K].setValue(I);case"italic":I=F?false:G.one("i")!==null;return this._buttonDict[K].setValue(I);case"underline":I=F?false:G.one("u")!==null;return this._buttonDict[K].setValue(I);case"file":if(this._buttonDict.height){this._buttonDict.height.setValue(G._node.height);}if(this._buttonDict.width){this._buttonDict.width.setValue(G._node.width);}return;case"font-family":case"font-size":case"color":case"background-color":I=F?false:this._getStyleValue(G,K);
return this._buttonDict[K].setValue(I);case"url":I=F?false:this._getStyleValue(G,K);return this._buttonDict[K].setValue(I);}},this);},updateSpinnerMaxWidth:function(){var I=this.get("spinnerMaxWidth"),L=this._buttonDict["padding-left"],K=this._buttonDict["padding-right"],E=this._buttonDict.width,J=L?L.getValue():0,F=K?K.getValue():0,G=E?E.getValue():0,N=E?I-G-F:I,H=E?I-G-J:I,M=E?I-J-F:I;if(L){L.set("max",N);}if(E){E.set("max",M);}if(K){K.set("max",H);}return{"padding-left":N,"padding-right":H,"width":M};},_onButtonClick:function(E,G){var F=this.get("activeButtons");D.Object.each(this._pickerButtons,function(I,H){if(F.indexOf(I)!=-1&&I!=E){this._buttonDict[I].hidePicker();}},this);D.each(this._editors,function(J,I){var H=J.bewypeEditorTag||J.bewypeEditorText;H.onButtonClick(E,G);});},_onButtonChange:function(E,G){if(E==="apply"){this.get("host").unplug(D.Bewype.EditorPanel);return D.fire("bewype-editor:onClose");}var F=false;D.each(this._editors,function(J,I){var H=J.bewypeEditorTag||J.bewypeEditorText;F|=H.onButtonChange(E,G);});return F?D.fire("bewype-editor:onChange"):null;},_onSpinnerChange:function(E,G){var F=false;D.each(this._editors,function(J,I){var H=J.bewypeEditorTag||J.bewypeEditorText;F|=H.onSpinnerChange(E,G);});return F?D.fire("bewype-editor:onChange"):null;}});D.augment(C,D.EventTarget);D.namespace("Bewype");D.Bewype.EditorPanel=C;},"@VERSION@",{requires:["bewype-button","bewype-entry-spinner","bewype-utils","dataschema","event-custom","json-stringify","bewype-editor-config"]});